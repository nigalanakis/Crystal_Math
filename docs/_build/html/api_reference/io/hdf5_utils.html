

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>hdf5_utils module &mdash; Crystal Structure Analysis (CSA) 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=d6d662bc" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=d6d662bc" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=51b770b3"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../_static/copybutton.js?v=9f22d18c"></script>
      <script src="../../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../../_static/custom.js?v=398222f2"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="dimension_scanner module" href="dimension_scanner.html" />
    <link rel="prev" title="data_writer module" href="data_writer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Crystal Structure Analysis (CSA)
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#quick-start-path-55-minutes">Quick Start Path (55 minutes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#detailed-learning-path">Detailed Learning Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#choose-your-starting-point">Choose Your Starting Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#what-you-ll-accomplish">What You’ll Accomplish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#common-research-applications">Common Research Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#essential-next-steps">Essential Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#getting-help">Getting Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/index.html#ready-to-begin">Ready to Begin?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#system-requirements">System Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#step-1-install-python-and-prerequisites">Step 1: Install Python and Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#step-2-install-ccdc-software">Step 2: Install CCDC Software</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#step-3-install-csa">Step 3: Install CSA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#step-4-configure-csa">Step 4: Configure CSA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#step-5-gpu-setup-optional-but-recommended">Step 5: GPU Setup (Optional but Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#step-6-verify-installation">Step 6: Verify Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html">Quickstart Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#the-five-stage-csa-pipeline">The Five-Stage CSA Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#step-1-create-your-configuration">Step 1: Create Your Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#step-2-run-your-first-analysis">Step 2: Run Your First Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#step-3-explore-your-results">Step 3: Explore Your Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#step-4-your-first-analysis">Step 4: Your First Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#step-5-understanding-your-results">Step 5: Understanding Your Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#common-issues-and-solutions">Common Issues and Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#next-steps-expanding-your-analysis">Next Steps: Expanding Your Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#congratulations">Congratulations!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/quickstart.html#ready-for-more">Ready for More?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#quick-start-configuration">Quick Start Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#essential-parameters">Essential Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#performance-settings">Performance Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#common-configurations">Common Configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#creating-your-configuration">Creating Your Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#validation-and-testing">Validation and Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#common-beginner-mistakes">Common Beginner Mistakes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#getting-help">Getting Help</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#next-steps">Next Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../getting_started/configuration.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#system-requirements">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#step-1-install-python-and-prerequisites">Step 1: Install Python and Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#python-3-9-installation">Python 3.9 Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#step-2-install-ccdc-software">Step 2: Install CCDC Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#csd-software-suite">CSD Software Suite</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#step-3-install-csa">Step 3: Install CSA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#download-csa">Download CSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#create-virtual-environment">Create Virtual Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#install-dependencies">Install Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#step-4-configure-csa">Step 4: Configure CSA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#set-environment-variables">Set Environment Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#step-5-gpu-setup-optional-but-recommended">Step 5: GPU Setup (Optional but Recommended)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#cuda-installation">CUDA Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#step-6-verify-installation">Step 6: Verify Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#quick-verification-script">Quick Verification Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#common-installation-issues">Common Installation Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/installation.html#getting-additional-help">Getting Additional Help</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/quickstart.html">Quickstart Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#the-five-stage-csa-pipeline">The Five-Stage CSA Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#step-1-create-your-configuration">Step 1: Create Your Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#create-a-simple-configuration">Create a Simple Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#configuration-explained">Configuration Explained</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#step-2-run-your-first-analysis">Step 2: Run Your First Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#execute-the-pipeline">Execute the Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#monitor-progress">Monitor Progress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#understanding-the-stages">Understanding the Stages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#step-3-explore-your-results">Step 3: Explore Your Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#check-generated-files">Check Generated Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#quick-data-overview">Quick Data Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#step-4-your-first-analysis">Step 4: Your First Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#crystal-property-analysis">Crystal Property Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#fragment-shape-analysis">Fragment Shape Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#step-5-understanding-your-results">Step 5: Understanding Your Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#what-you-ve-created">What You’ve Created</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#key-insights-from-your-data">Key Insights from Your Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#common-issues-and-solutions">Common Issues and Solutions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#no-structures-found">“No structures found”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#out-of-memory-errors">“Out of memory” errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#very-slow-processing">“Very slow processing”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#next-steps-expanding-your-analysis">Next Steps: Expanding Your Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#try-different-chemical-systems">Try Different Chemical Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#explore-advanced-features">Explore Advanced Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/quickstart.html#scale-up-your-research">Scale Up Your Research</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#congratulations">Congratulations!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/quickstart.html#ready-for-more">Ready for More?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#quick-start-configuration">Quick Start Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#minimal-configuration">Minimal Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#complete-basic-configuration">Complete Basic Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#essential-parameters">Essential Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#required-settings">Required Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#pipeline-control">Pipeline Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#basic-filters">Basic Filters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#performance-settings">Performance Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#batch-sizes">Batch Sizes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#common-configurations">Common Configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#small-organic-molecules">Small Organic Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#drug-like-molecules">Drug-Like Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#quick-test-run">Quick Test Run</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#creating-your-configuration">Creating Your Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#step-by-step-process">Step-by-Step Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#validation-and-testing">Validation and Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#check-your-json">Check Your JSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#test-with-small-dataset">Test with Small Dataset</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#common-beginner-mistakes">Common Beginner Mistakes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#json-syntax-errors">JSON Syntax Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#configuration-issues">Configuration Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#getting-help">Getting Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../getting_started/configuration.html#when-things-go-wrong">When Things Go Wrong</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getting_started/configuration.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_guide/index.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/index.html#core-concepts">Core Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#essential-concepts">Essential Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#key-features-at-a-glance">Key Features at a Glance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#common-workflows">Common Workflows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/index.html#understanding-csa-s-approach">Understanding CSA’s Approach</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#scientific-foundation">Scientific Foundation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#technical-architecture">Technical Architecture</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/index.html#user-guide-sections">User Guide Sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#core-workflows">Core Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/pipeline_overview.html">Pipeline Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/data_model.html">Data Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/configuration.html">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../user_guide/basic_analysis.html">Basic Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#advanced-techniques">Advanced Techniques</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#data-management">Data Management</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#performance-optimization">Performance Optimization</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/index.html#getting-the-most-from-csa">Getting the Most from CSA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#best-practices">Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#performance-tips">Performance Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../user_guide/index.html#common-pitfalls">Common Pitfalls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/index.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#getting-started-tutorials">Getting Started Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#domain-specific-tutorials">Domain-Specific Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#advanced-analysis-tutorials">Advanced Analysis Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#specialized-workflows">Specialized Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#tutorial-structure">Tutorial Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#quick-start-recommendations">Quick Start Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#tutorial-downloads">Tutorial Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#tutorial-support">Tutorial Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#contributing-tutorials">Contributing Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#learning-paths">Learning Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#advanced-topics">Advanced Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#feedback-and-improvement">Feedback and Improvement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/index.html#getting-help">Getting Help</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#quick-start-examples">Quick Start Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#data-access-examples">Data Access Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#analysis-examples">Analysis Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#visualization-examples">Visualization Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#performance-examples">Performance Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#example-categories">Example Categories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html#basic-data-operations">Basic Data Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html#advanced-workflows">Advanced Workflows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#configuration-templates">Configuration Templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html#common-configuration-patterns">Common Configuration Patterns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html#commonly-used-helper-functions">Commonly Used Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#interactive-examples">Interactive Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html#jupyter-notebook-examples">Jupyter Notebook Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html#command-line-examples">Command Line Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#troubleshooting-examples">Troubleshooting Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/index.html#common-issues-and-solutions">Common Issues and Solutions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#example-downloads">Example Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/index.html#browse-examples-by-category">Browse Examples by Category</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../core/crystal_analyzer.html">crystal_analyzer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.extraction_config"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.extraction_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.csd_ops"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.csd_ops</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.extractor"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.extractor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.data_dir"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.data_dir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.extract_data"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.extract_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#crystalanalyzer-class">CrystalAnalyzer Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#id0"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#methods">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#extract-data">extract_data()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#private-methods">Private Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/crystal_analyzer.html#private-attributes">Private Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#configuration-dependencies">Configuration Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/crystal_analyzer.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../core/csa_config.html">csa_config module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.from_json"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.data_directory"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.data_directory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.data_prefix"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.data_prefix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.actions"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.actions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.filters"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.filters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.extraction_batch_size"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.extraction_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.post_extraction_batch_size"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.post_extraction_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#id0"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#csa_config.ExtractionConfig.__init__"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#csa_config.load_config"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#configuration-management-for-csa-pipeline">Configuration Management for CSA Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#extractionconfig-class">ExtractionConfig Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#id1"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#configuration-loading-functions">Configuration Loading Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_config.html#id12"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#configuration-validation">Configuration Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_config.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../core/csa_main.html">csa_main module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#csa_main.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#csa_main.parse_args"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#csa_main.run_extraction"><code class="docutils literal notranslate"><span class="pre">run_extraction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#csa_main.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#command-line-interface-for-csa-pipeline">Command-Line Interface for CSA Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#main-functions">Main Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_main.html#id0"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_main.html#id2"><code class="docutils literal notranslate"><span class="pre">run_extraction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#configuration-and-logging">Configuration and Logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_main.html#id3"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../core/csa_main.html#id4"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#command-line-usage">Command-Line Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/csa_main.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extraction/csd_operations.html">csd_operations module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.distance_tolerance"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.distance_tolerance</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.angle_tolerance"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.angle_tolerance</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_bond_types"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_bond_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_hydrogen_counts"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_hydrogen_counts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_hydrogen_positions"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_hydrogen_positions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.packing_shell_size"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.packing_shell_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_spacegroup"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_spacegroup</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.normalise_unit_cell"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.normalise_unit_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.SimilaritySettings.__init__"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations"><code class="docutils literal notranslate"><span class="pre">CSDOperations</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.data_directory"><code class="docutils literal notranslate"><span class="pre">CSDOperations.data_directory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.data_prefix"><code class="docutils literal notranslate"><span class="pre">CSDOperations.data_prefix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.reader"><code class="docutils literal notranslate"><span class="pre">CSDOperations.reader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.similarity_engine"><code class="docutils literal notranslate"><span class="pre">CSDOperations.similarity_engine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.__init__"><code class="docutils literal notranslate"><span class="pre">CSDOperations.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.get_refcode_families_df"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_refcode_families_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.save_refcode_families_csv"><code class="docutils literal notranslate"><span class="pre">CSDOperations.save_refcode_families_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.filter_families_by_size"><code class="docutils literal notranslate"><span class="pre">CSDOperations.filter_families_by_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.cluster_families"><code class="docutils literal notranslate"><span class="pre">CSDOperations.cluster_families()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations.get_unique_structures"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_unique_structures()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#cambridge-structural-database-operations">Cambridge Structural Database Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#similaritysettings-class">SimilaritySettings Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#id0"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#csdoperations-class">CSDOperations Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#id11"><code class="docutils literal notranslate"><span class="pre">CSDOperations</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#family-extraction-methods">Family Extraction Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#id25"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_refcode_families_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#id26"><code class="docutils literal notranslate"><span class="pre">CSDOperations.save_refcode_families_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#id27"><code class="docutils literal notranslate"><span class="pre">CSDOperations.filter_families_by_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#clustering-methods">Clustering Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#id28"><code class="docutils literal notranslate"><span class="pre">CSDOperations.cluster_families()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations._check_structure"><code class="docutils literal notranslate"><span class="pre">CSDOperations._check_structure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#representative-selection-methods">Representative Selection Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#id30"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_unique_structures()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations.CSDOperations._save_unique_structures"><code class="docutils literal notranslate"><span class="pre">CSDOperations._save_unique_structures()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations._process_single_family"><code class="docutils literal notranslate"><span class="pre">_process_single_family()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/csd_operations.html#csd_operations._representative_for_cluster"><code class="docutils literal notranslate"><span class="pre">_representative_for_cluster()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/csd_operations.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extraction/structure_data_extractor.html">structure_data_extractor module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.hdf5_path"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.hdf5_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.filters"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.filters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.batch_size"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.reader"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.reader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.__init__"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.run"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#raw-structure-data-extraction-pipeline">Raw Structure Data Extraction Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#structuredataextractor-class">StructureDataExtractor Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#id0"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#data-extraction-functions">Data Extraction Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_data_extractor.html#structure_data_extractor._extract_one"><code class="docutils literal notranslate"><span class="pre">_extract_one()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#hdf5-data-organization">HDF5 Data Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#data-access-patterns">Data Access Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_data_extractor.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html">structure_post_extraction_processor module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams"><code class="docutils literal notranslate"><span class="pre">CrystalParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.cell_lengths"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.cell_angles"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id0"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id3"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.count"><code class="docutils literal notranslate"><span class="pre">CrystalParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.index"><code class="docutils literal notranslate"><span class="pre">CrystalParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams"><code class="docutils literal notranslate"><span class="pre">AtomParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.labels"><code class="docutils literal notranslate"><span class="pre">AtomParams.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.symbols"><code class="docutils literal notranslate"><span class="pre">AtomParams.symbols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.coords"><code class="docutils literal notranslate"><span class="pre">AtomParams.coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.frac_coords"><code class="docutils literal notranslate"><span class="pre">AtomParams.frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.mask"><code class="docutils literal notranslate"><span class="pre">AtomParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.weights"><code class="docutils literal notranslate"><span class="pre">AtomParams.weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.charges"><code class="docutils literal notranslate"><span class="pre">AtomParams.charges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id4"><code class="docutils literal notranslate"><span class="pre">AtomParams.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id5"><code class="docutils literal notranslate"><span class="pre">AtomParams.symbols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id6"><code class="docutils literal notranslate"><span class="pre">AtomParams.coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id7"><code class="docutils literal notranslate"><span class="pre">AtomParams.frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id8"><code class="docutils literal notranslate"><span class="pre">AtomParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id9"><code class="docutils literal notranslate"><span class="pre">AtomParams.weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id10"><code class="docutils literal notranslate"><span class="pre">AtomParams.charges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.count"><code class="docutils literal notranslate"><span class="pre">AtomParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.index"><code class="docutils literal notranslate"><span class="pre">AtomParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams"><code class="docutils literal notranslate"><span class="pre">BondParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.atom1_idx"><code class="docutils literal notranslate"><span class="pre">BondParams.atom1_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.atom2_idx"><code class="docutils literal notranslate"><span class="pre">BondParams.atom2_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.bond_type"><code class="docutils literal notranslate"><span class="pre">BondParams.bond_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.is_rotatable_raw"><code class="docutils literal notranslate"><span class="pre">BondParams.is_rotatable_raw</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.is_cyclic"><code class="docutils literal notranslate"><span class="pre">BondParams.is_cyclic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.mask"><code class="docutils literal notranslate"><span class="pre">BondParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id11"><code class="docutils literal notranslate"><span class="pre">BondParams.atom1_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id12"><code class="docutils literal notranslate"><span class="pre">BondParams.atom2_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id13"><code class="docutils literal notranslate"><span class="pre">BondParams.bond_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id14"><code class="docutils literal notranslate"><span class="pre">BondParams.is_rotatable_raw</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id15"><code class="docutils literal notranslate"><span class="pre">BondParams.is_cyclic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id16"><code class="docutils literal notranslate"><span class="pre">BondParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.count"><code class="docutils literal notranslate"><span class="pre">BondParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.index"><code class="docutils literal notranslate"><span class="pre">BondParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams"><code class="docutils literal notranslate"><span class="pre">InterCCParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.central_atom"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.contact_atom"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.central_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.contact_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.central_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.contact_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.lengths"><code class="docutils literal notranslate"><span class="pre">InterCCParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.strengths"><code class="docutils literal notranslate"><span class="pre">InterCCParams.strengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.in_los"><code class="docutils literal notranslate"><span class="pre">InterCCParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_A"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_T"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_A_inv"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_T_inv"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id17"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id18"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id19"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id20"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id21"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id22"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id23"><code class="docutils literal notranslate"><span class="pre">InterCCParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id24"><code class="docutils literal notranslate"><span class="pre">InterCCParams.strengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id25"><code class="docutils literal notranslate"><span class="pre">InterCCParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id26"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id27"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id28"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id29"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.count"><code class="docutils literal notranslate"><span class="pre">InterCCParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.index"><code class="docutils literal notranslate"><span class="pre">InterCCParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams"><code class="docutils literal notranslate"><span class="pre">InterHBParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.central_atom"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.hydrogen_atom"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.contact_atom"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.central_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.hydrogen_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.contact_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.central_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.hydrogen_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.contact_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.lengths"><code class="docutils literal notranslate"><span class="pre">InterHBParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.angles"><code class="docutils literal notranslate"><span class="pre">InterHBParams.angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.in_los"><code class="docutils literal notranslate"><span class="pre">InterHBParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_A"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_T"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_A_inv"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_T_inv"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id30"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id31"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id32"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id33"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id34"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id35"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id36"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id37"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id38"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id39"><code class="docutils literal notranslate"><span class="pre">InterHBParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id40"><code class="docutils literal notranslate"><span class="pre">InterHBParams.angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id41"><code class="docutils literal notranslate"><span class="pre">InterHBParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id42"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id43"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id44"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id45"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.count"><code class="docutils literal notranslate"><span class="pre">InterHBParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.index"><code class="docutils literal notranslate"><span class="pre">InterHBParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor.__init__"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor.run"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#advanced-feature-engineering-pipeline">Advanced Feature Engineering Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#data-structure-classes">Data Structure Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id46"><code class="docutils literal notranslate"><span class="pre">CrystalParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id53"><code class="docutils literal notranslate"><span class="pre">AtomParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id70"><code class="docutils literal notranslate"><span class="pre">BondParams</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structurepostextractionprocessor-class">StructurePostExtractionProcessor Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#id85"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#fragment-analysis-methods">Fragment Analysis Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._compute_rigid_fragments"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._compute_rigid_fragments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#geometric-computation-methods">Geometric Computation Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._compute_fragment_com_centroid"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._compute_fragment_com_centroid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#contact-analysis-methods">Contact Analysis Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._expand_inter_contacts"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._expand_inter_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._flag_hbond_contacts"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._flag_hbond_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._identify_contact_fragments"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._identify_contact_fragments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#advanced-feature-computation">Advanced Feature Computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._compute_contact_com_vectors"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._compute_contact_com_vectors()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#data-writing-and-i-o-methods">Data Writing and I/O Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extraction/structure_post_extraction_processor.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../processing/geometry_utils.html">geometry_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_distances_to_crystallographic_planes_frac_batch"><code class="docutils literal notranslate"><span class="pre">compute_distances_to_crystallographic_planes_frac_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_angles_between_bonds_and_crystallographic_planes_frac_batch"><code class="docutils literal notranslate"><span class="pre">compute_angles_between_bonds_and_crystallographic_planes_frac_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_atom_vectors_to_point_batch"><code class="docutils literal notranslate"><span class="pre">compute_atom_vectors_to_point_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_bond_rotatability_batch"><code class="docutils literal notranslate"><span class="pre">compute_bond_rotatability_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_bond_angles_batch"><code class="docutils literal notranslate"><span class="pre">compute_bond_angles_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_torsion_angles_batch"><code class="docutils literal notranslate"><span class="pre">compute_torsion_angles_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_quaternions_from_rotation_matrices"><code class="docutils literal notranslate"><span class="pre">compute_quaternions_from_rotation_matrices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_global_steinhardt_order_parameters_batch"><code class="docutils literal notranslate"><span class="pre">compute_global_steinhardt_order_parameters_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_best_fit_plane_batch"><code class="docutils literal notranslate"><span class="pre">compute_best_fit_plane_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_planarity_metrics_batch"><code class="docutils literal notranslate"><span class="pre">compute_planarity_metrics_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometry_utils.compute_fragment_pairwise_vectors_and_distances_batch"><code class="docutils literal notranslate"><span class="pre">compute_fragment_pairwise_vectors_and_distances_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#geometric-calculations-and-descriptors">Geometric Calculations and Descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#bond-angle-calculations">Bond Angle Calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#torsion-angle-calculations">Torsion Angle Calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#bond-rotatability-analysis">Bond Rotatability Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#planarity-analysis">Planarity Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#crystallographic-analysis">Crystallographic Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#order-parameter-analysis">Order Parameter Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#coordinate-transformations">Coordinate Transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/geometry_utils.html#fragment-pairwise-analysis">Fragment Pairwise Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/geometry_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../processing/fragment_utils.html">fragment_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#fragment_utils.identify_rigid_fragments_batch"><code class="docutils literal notranslate"><span class="pre">identify_rigid_fragments_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#fragment_utils.prepare_fragments_batch"><code class="docutils literal notranslate"><span class="pre">prepare_fragments_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#fragment_utils.compute_center_of_mass_batch"><code class="docutils literal notranslate"><span class="pre">compute_center_of_mass_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#fragment_utils.compute_centroid_batch"><code class="docutils literal notranslate"><span class="pre">compute_centroid_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#fragment_utils.compute_inertia_tensor_batch"><code class="docutils literal notranslate"><span class="pre">compute_inertia_tensor_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#fragment_utils.compute_quadrupole_tensor_batch"><code class="docutils literal notranslate"><span class="pre">compute_quadrupole_tensor_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#molecular-fragment-analysis-and-processing">Molecular Fragment Analysis and Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#fragment-identification">Fragment Identification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/fragment_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">identify_rigid_fragments_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/fragment_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">prepare_fragments_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#center-calculations">Center Calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/fragment_utils.html#id2"><code class="docutils literal notranslate"><span class="pre">compute_center_of_mass_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/fragment_utils.html#id3"><code class="docutils literal notranslate"><span class="pre">compute_centroid_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#tensor-analysis">Tensor Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/fragment_utils.html#id4"><code class="docutils literal notranslate"><span class="pre">compute_inertia_tensor_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/fragment_utils.html#id5"><code class="docutils literal notranslate"><span class="pre">compute_quadrupole_tensor_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#shape-descriptors-and-analysis">Shape Descriptors and Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/fragment_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../processing/contact_utils.html">contact_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#contact_utils.compute_symmetric_contacts_batch"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_contacts_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#contact_utils.compute_symmetric_hbonds_batch"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_hbonds_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#contact_utils.compute_contact_is_hbond"><code class="docutils literal notranslate"><span class="pre">compute_contact_is_hbond()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#contact_utils.compute_contact_fragment_indices_batch"><code class="docutils literal notranslate"><span class="pre">compute_contact_fragment_indices_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#contact_utils.compute_contact_atom_to_central_fragment_com_batch"><code class="docutils literal notranslate"><span class="pre">compute_contact_atom_to_central_fragment_com_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#intermolecular-contact-analysis-and-symmetry-expansion">Intermolecular Contact Analysis and Symmetry Expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#core-contact-functions">Core Contact Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/contact_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_contacts_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#hydrogen-bond-analysis">Hydrogen Bond Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/contact_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_hbonds_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#contact-classification-and-validation">Contact Classification and Validation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/contact_utils.html#id2"><code class="docutils literal notranslate"><span class="pre">compute_contact_is_hbond()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#fragment-level-contact-analysis">Fragment-Level Contact Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/contact_utils.html#id3"><code class="docutils literal notranslate"><span class="pre">compute_contact_fragment_indices_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/contact_utils.html#id4"><code class="docutils literal notranslate"><span class="pre">compute_contact_atom_to_central_fragment_com_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#advanced-contact-analysis">Advanced Contact Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/contact_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../processing/cell_utils.html">cell_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#cell_utils.compute_scaled_cell"><code class="docutils literal notranslate"><span class="pre">compute_scaled_cell()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#cell_utils.compute_cell_matrix_batch"><code class="docutils literal notranslate"><span class="pre">compute_cell_matrix_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#crystallographic-unit-cell-transformations-and-matrix-operations">Crystallographic Unit Cell Transformations and Matrix Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/cell_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">compute_cell_matrix_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/cell_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">compute_scaled_cell()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#advanced-cell-operations">Advanced Cell Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/cell_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../processing/symmetry_utils.html">symmetry_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#symmetry_utils.parse_sym_op"><code class="docutils literal notranslate"><span class="pre">parse_sym_op()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#symmetry_utils.invert_sym_op"><code class="docutils literal notranslate"><span class="pre">invert_sym_op()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#symmetry_utils.add_symmetry_matrices"><code class="docutils literal notranslate"><span class="pre">add_symmetry_matrices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#symmetry_utils.add_inter_cc_symmetry"><code class="docutils literal notranslate"><span class="pre">add_inter_cc_symmetry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#symmetry_utils.add_inter_hb_symmetry"><code class="docutils literal notranslate"><span class="pre">add_inter_hb_symmetry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#crystallographic-symmetry-operations-and-parsing">Crystallographic Symmetry Operations and Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/symmetry_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">parse_sym_op()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/symmetry_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">invert_sym_op()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#batch-symmetry-processing">Batch Symmetry Processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/symmetry_utils.html#id2"><code class="docutils literal notranslate"><span class="pre">add_symmetry_matrices()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#contact-specific-symmetry-functions">Contact-Specific Symmetry Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../processing/symmetry_utils.html#id3"><code class="docutils literal notranslate"><span class="pre">add_inter_cc_symmetry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../processing/symmetry_utils.html#id4"><code class="docutils literal notranslate"><span class="pre">add_inter_hb_symmetry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#advanced-symmetry-analysis">Advanced Symmetry Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../processing/symmetry_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data_reader.html">data_reader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader"><code class="docutils literal notranslate"><span class="pre">RawDataReader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.h5_in"><code class="docutils literal notranslate"><span class="pre">RawDataReader.h5_in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.read_crystal_parameters"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_crystal_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.read_atoms"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.read_bonds"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.read_intermolecular_contacts"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.read_intermolecular_hbonds"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_hbonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.read_intramolecular_contacts"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.read_intramolecular_hbonds"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_hbonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#data_reader.RawDataReader.__init__"><code class="docutils literal notranslate"><span class="pre">RawDataReader.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id0"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_crystal_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id1"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id2"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id3"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id4"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_hbonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id5"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id6"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_hbonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#hdf5-raw-data-reading-and-batch-loading">HDF5 Raw Data Reading and Batch Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#rawdatareader-class">RawDataReader Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id7"><code class="docutils literal notranslate"><span class="pre">RawDataReader</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#crystal-parameter-reading">Crystal Parameter Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id25"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_crystal_parameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#atomic-data-reading">Atomic Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id26"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_atoms()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#bond-data-reading">Bond Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id27"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_bonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#contact-data-reading">Contact Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id28"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id29"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_hbonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#intramolecular-data-reading">Intramolecular Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id30"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_reader.html#id31"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_hbonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#advanced-usage-patterns">Advanced Usage Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#error-handling-and-diagnostics">Error Handling and Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_reader.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data_writer.html">data_writer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter"><code class="docutils literal notranslate"><span class="pre">RawDataWriter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter.h5_out"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.h5_out</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter.write_raw_crystal_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter.write_raw_atom_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter.write_raw_bond_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter.write_raw_intramolecular_contact_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter.write_raw_intramolecular_hbond_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_hbond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.RawDataWriter.__init__"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id0"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id1"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id2"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id3"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id4"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_hbond_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.h5_out"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.h5_out</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.write_computed_crystal_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.write_computed_atom_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.write_computed_bond_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.write_computed_molecule_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_molecule_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.write_computed_intermolecular_contact_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.write_computed_intermolecular_hbond_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_hbond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.__init__"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id5"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id6"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id7"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id8"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_molecule_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id9"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id10"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_hbond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#data_writer.ComputedDataWriter.write_computed_fragment_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_fragment_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#hdf5-data-writing-and-storage-management">HDF5 Data Writing and Storage Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#writer-classes-overview">Writer Classes Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#rawdatawriter-class">RawDataWriter Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id11"><code class="docutils literal notranslate"><span class="pre">RawDataWriter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#crystal-data-writing">Crystal Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id25"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_crystal_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#atomic-data-writing">Atomic Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id26"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_atom_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#bond-data-writing">Bond Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id27"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_bond_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#contact-data-writing">Contact Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id28"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id29"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_hbond_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#computeddatawriter-class">ComputedDataWriter Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id30"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#computed-data-writing-methods">Computed Data Writing Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id47"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id48"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id49"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id50"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_molecule_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="data_writer.html#id51"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_fragment_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#advanced-writing-patterns">Advanced Writing Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#data-type-management">Data Type Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="data_writer.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">hdf5_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdf5_utils.initialize_hdf5_file"><code class="docutils literal notranslate"><span class="pre">initialize_hdf5_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdf5_utils.write_structure_group"><code class="docutils literal notranslate"><span class="pre">write_structure_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hdf5-file-initialization-and-management-utilities">HDF5 File Initialization and Management Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">initialize_hdf5_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">write_structure_group()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-hdf5-management">Advanced HDF5 Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dimension_scanner.html">dimension_scanner module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dimension_scanner.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="dimension_scanner.html#dimension_scanner.scan_max_dimensions"><code class="docutils literal notranslate"><span class="pre">scan_max_dimensions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dimension_scanner.html#hdf5-dataset-dimension-analysis-and-optimization">HDF5 Dataset Dimension Analysis and Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="dimension_scanner.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="dimension_scanner.html#id0"><code class="docutils literal notranslate"><span class="pre">scan_max_dimensions()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#module-overview">Module Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index.html#core-modules">Core Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#extraction-pipeline">Extraction Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#processing-utilities">Processing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#input-output">Input/Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#validation">Validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#quick-reference">Quick Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index.html#most-common-classes">Most Common Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/crystal_analyzer.CrystalAnalyzer.html">crystal_analyzer.CrystalAnalyzer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/csa_config.ExtractionConfig.html">csa_config.ExtractionConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/csd_operations.CSDOperations.html">csd_operations.CSDOperations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/structure_data_extractor.StructureDataExtractor.html">structure_data_extractor.StructureDataExtractor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/structure_post_extraction_processor.StructurePostExtractionProcessor.html">structure_post_extraction_processor.StructurePostExtractionProcessor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#key-functions">Key Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/csa_config.load_config.html">csa_config.load_config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/geometry_utils.compute_bond_angles_batch.html">geometry_utils.compute_bond_angles_batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/fragment_utils.identify_rigid_fragments_batch.html">fragment_utils.identify_rigid_fragments_batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/contact_utils.compute_symmetric_contacts_batch.html">contact_utils.compute_symmetric_contacts_batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/cell_utils.compute_cell_matrix_batch.html">cell_utils.compute_cell_matrix_batch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#data-structures">Data Structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/csd_structure_validator.StructureValidationResult.html">csd_structure_validator.StructureValidationResult</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/structure_post_extraction_processor.CrystalParams.html">structure_post_extraction_processor.CrystalParams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/structure_post_extraction_processor.AtomParams.html">structure_post_extraction_processor.AtomParams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/structure_post_extraction_processor.BondParams.html">structure_post_extraction_processor.BondParams</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#usage-patterns">Usage Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index.html#basic-pipeline-setup">Basic Pipeline Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#custom-processing">Custom Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#batch-geometric-calculations">Batch Geometric Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#data-access-patterns">Data Access Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#configuration-management">Configuration Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#error-handling-patterns">Error Handling Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#performance-optimization">Performance Optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#module-dependencies">Module Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#import-patterns">Import Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#common-workflows">Common Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#advanced-usage-examples">Advanced Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Details</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html">Performance Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#data-storage-design">Data Storage Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#hdf5-schema-architecture">HDF5 Schema Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#algorithm-details">Algorithm Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#similarity-clustering-algorithm">Similarity Clustering Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#geometric-calculation-algorithms">Geometric Calculation Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#fragment-analysis-algorithms">Fragment Analysis Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#contact-detection-algorithms">Contact Detection Algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#performance-optimization-details">Performance Optimization Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#gpu-memory-management">GPU Memory Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#testing-and-validation">Testing and Validation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#unit-testing-framework">Unit Testing Framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#documentation-and-maintenance">Documentation and Maintenance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#code-documentation-standards">Code Documentation Standards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#algorithms-and-methods">Algorithms and Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#implementation-details">Implementation Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_details/index.html#system-architecture">System Architecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#high-level-design">High-Level Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_details/index.html#core-components">Core Components</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Crystal Structure Analysis (CSA)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">API Reference</a></li>
      <li class="breadcrumb-item active">hdf5_utils module</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/your-org/crystal-structure-analysis/blob/main/docs/source/api_reference/io/hdf5_utils.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-hdf5_utils">
<span id="hdf5-utils-module"></span><h1>hdf5_utils module<a class="headerlink" href="#module-hdf5_utils" title="Link to this heading"></a></h1>
<p>Module: hdf5_utils.py</p>
<p>Utilities to initialize and update HDF5 files for storing batched CSD structure data.</p>
<section id="dependencies">
<h2>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h2>
<p>pathlib
h5py</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="hdf5_utils.initialize_hdf5_file">
<span class="sig-prename descclassname"><span class="pre">hdf5_utils.</span></span><span class="sig-name descname"><span class="pre">initialize_hdf5_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdf5_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gzip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hdf5_utils.html#initialize_hdf5_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hdf5_utils.initialize_hdf5_file" title="Link to this definition"></a></dt>
<dd><p>Create or open an HDF5 file and ensure the top-level ‘/structures’ group exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hdf5_path</strong> (<em>Path</em>) – Path to the HDF5 file. If it does not exist, it will be created.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;gzip&quot;</em>) – Compression algorithm to use for future datasets (not applied at group level).</p></li>
<li><p><strong>chunk_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=64</em>) – Suggested chunk size for any future dataset creation (placeholder).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>h5py.File</em> – An open HDF5 file handle in mode “a” (append).</p></li>
<li><p><em>Side Effects</em></p></li>
<li><p><em>————</em></p></li>
<li><p><em>- Creates the file at hdf5_path if it does not exist.</em></p></li>
<li><p><em>- Adds a group named ‘/structures’ if it is missing.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#OSError" title="(in Python v3.13)"><strong>OSError</strong></a> – If the file cannot be opened or created.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.h5py.org/en/stable/high/file.html#h5py.File" title="(in h5py v3.14)">h5py.File</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hdf5_utils.write_structure_group">
<span class="sig-prename descclassname"><span class="pre">hdf5_utils.</span></span><span class="sig-name descname"><span class="pre">write_structure_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_json</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hdf5_utils.html#write_structure_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hdf5_utils.write_structure_group" title="Link to this definition"></a></dt>
<dd><p>Store a raw JSON string under ‘/structures/&lt;refcode&gt;/raw_json’, replacing any existing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5</strong> (<a class="reference external" href="https://docs.h5py.org/en/stable/high/file.html#h5py.File" title="(in h5py v3.14)"><em>h5py.File</em></a>) – An open HDF5 file, already structured with ‘/structures’ group.</p></li>
<li><p><strong>refcode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – CSD refcode to identify the subgroup.</p></li>
<li><p><strong>raw_json</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Fully serialized JSON blob containing raw fields for this structure.</p></li>
<li><p><strong>Effects</strong> (<em>Side</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>'/structures/&lt;refcode&gt;'.</strong> (<em>- Creates</em><em> or </em><em>retrieves the group</em>)</p></li>
<li><p><strong>group.</strong> (<em>- Deletes any existing 'raw_json' dataset under that</em>)</p></li>
<li><p><strong>string.</strong> (<em>- Creates a new 'raw_json' dataset</em><em> of </em><em>type variable-length UTF-8</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If ‘/structures’ group does not exist in h5 (should not happen if initialize_hdf5_file was used).</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#OSError" title="(in Python v3.13)"><strong>OSError</strong></a> – On dataset creation failure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="hdf5-file-initialization-and-management-utilities">
<h2>HDF5 File Initialization and Management Utilities<a class="headerlink" href="#hdf5-file-initialization-and-management-utilities" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">hdf5_utils</span></code> module provides essential utilities for creating, initializing, and managing HDF5 files used throughout the Crystal Structure Analysis pipeline. It handles file creation, group organization, and data storage patterns optimized for crystallographic structure data.</p>
<p><strong>Key Features:</strong></p>
<ul class="simple">
<li><p><strong>File initialization</strong> - Create properly structured HDF5 files</p></li>
<li><p><strong>Group management</strong> - Organize data into logical hierarchies</p></li>
<li><p><strong>Compression configuration</strong> - Optimize storage efficiency</p></li>
<li><p><strong>Error handling</strong> - Robust file operations with proper cleanup</p></li>
<li><p><strong>Metadata management</strong> - Store and retrieve file-level information</p></li>
<li><p><strong>Cross-platform compatibility</strong> - Consistent behavior across operating systems</p></li>
</ul>
</section>
<section id="core-functions">
<h2>Core Functions<a class="headerlink" href="#core-functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">hdf5_utils.</span></span><span class="sig-name descname"><span class="pre">initialize_hdf5_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdf5_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gzip'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hdf5_utils.html#initialize_hdf5_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Create or open an HDF5 file and ensure the top-level ‘/structures’ group exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hdf5_path</strong> (<em>Path</em>) – Path to the HDF5 file. If it does not exist, it will be created.</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>default=&quot;gzip&quot;</em>) – Compression algorithm to use for future datasets (not applied at group level).</p></li>
<li><p><strong>chunk_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>default=64</em>) – Suggested chunk size for any future dataset creation (placeholder).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>h5py.File</em> – An open HDF5 file handle in mode “a” (append).</p></li>
<li><p><em>Side Effects</em></p></li>
<li><p><em>————</em></p></li>
<li><p><em>- Creates the file at hdf5_path if it does not exist.</em></p></li>
<li><p><em>- Adds a group named ‘/structures’ if it is missing.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#OSError" title="(in Python v3.13)"><strong>OSError</strong></a> – If the file cannot be opened or created.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.h5py.org/en/stable/high/file.html#h5py.File" title="(in h5py v3.14)">h5py.File</a></p>
</dd>
</dl>
<p><strong>Create and Initialize HDF5 File Structure</strong></p>
<p>Creates a new HDF5 file or opens an existing one with the required group structure for CSA data storage. Ensures proper organization and compression settings.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><strong>hdf5_path</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">Path</span></code>) - Path to the HDF5 file to create or open</p></li>
<li><p><strong>compression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, default=”gzip”) - Compression algorithm for datasets</p></li>
<li><p><strong>chunk_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, default=64) - Suggested chunk size for dataset creation</p></li>
</ul>
<p><strong>Returns:</strong></p>
<ul class="simple">
<li><p><strong>h5py.File</strong> - Open HDF5 file handle in append mode</p></li>
</ul>
<p><strong>File Structure Created:</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>/
├── structures/          # Main data group
│   ├── &lt;refcode1&gt;/     # Individual structure groups
│   ├── &lt;refcode2&gt;/
│   └── ...
├── metadata/           # File-level metadata (optional)
└── processing_log/     # Processing history (optional)
</pre></div>
</div>
<p><strong>Usage Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">hdf5_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize_hdf5_file</span>

<span class="c1"># Create new HDF5 file for raw data</span>
<span class="n">hdf5_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;structures_raw.h5&quot;</span><span class="p">)</span>
<span class="n">h5_file</span> <span class="o">=</span> <span class="n">initialize_hdf5_file</span><span class="p">(</span><span class="n">hdf5_path</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>

<span class="c1"># File is ready for data storage</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Available groups:&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">h5_file</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="c1"># Expected: [&#39;structures&#39;]</span>

<span class="c1"># Close when done</span>
<span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Advanced Configuration:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure for large datasets</span>
<span class="n">large_dataset_file</span> <span class="o">=</span> <span class="n">initialize_hdf5_file</span><span class="p">(</span>
    <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;large_structures.h5&quot;</span><span class="p">),</span>
    <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;lzf&quot;</span><span class="p">,</span>  <span class="c1"># Faster compression for large files</span>
    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">128</span>      <span class="c1"># Larger chunks for better I/O</span>
<span class="p">)</span>

<span class="c1"># Configure for maximum compression</span>
<span class="n">compressed_file</span> <span class="o">=</span> <span class="n">initialize_hdf5_file</span><span class="p">(</span>
    <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;compressed_structures.h5&quot;</span><span class="p">),</span>
    <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="o">=</span><span class="mi">16</span>       <span class="c1"># Smaller chunks for better compression</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Error Handling:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">h5_file</span> <span class="o">=</span> <span class="n">initialize_hdf5_file</span><span class="p">(</span><span class="n">hdf5_path</span><span class="p">)</span>
    <span class="c1"># Use file...</span>
<span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to create HDF5 file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Handle error appropriately</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;h5_file&#39;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">()</span> <span class="ow">and</span> <span class="n">h5_file</span><span class="p">:</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id1">
<span class="sig-prename descclassname"><span class="pre">hdf5_utils.</span></span><span class="sig-name descname"><span class="pre">write_structure_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refcode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_json</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/hdf5_utils.html#write_structure_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Store a raw JSON string under ‘/structures/&lt;refcode&gt;/raw_json’, replacing any existing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5</strong> (<a class="reference external" href="https://docs.h5py.org/en/stable/high/file.html#h5py.File" title="(in h5py v3.14)"><em>h5py.File</em></a>) – An open HDF5 file, already structured with ‘/structures’ group.</p></li>
<li><p><strong>refcode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – CSD refcode to identify the subgroup.</p></li>
<li><p><strong>raw_json</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Fully serialized JSON blob containing raw fields for this structure.</p></li>
<li><p><strong>Effects</strong> (<em>Side</em>)</p></li>
<li><p><strong>------------</strong></p></li>
<li><p><strong>'/structures/&lt;refcode&gt;'.</strong> (<em>- Creates</em><em> or </em><em>retrieves the group</em>)</p></li>
<li><p><strong>group.</strong> (<em>- Deletes any existing 'raw_json' dataset under that</em>)</p></li>
<li><p><strong>string.</strong> (<em>- Creates a new 'raw_json' dataset</em><em> of </em><em>type variable-length UTF-8</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.13)"><strong>KeyError</strong></a> – If ‘/structures’ group does not exist in h5 (should not happen if initialize_hdf5_file was used).</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#OSError" title="(in Python v3.13)"><strong>OSError</strong></a> – On dataset creation failure.</p></li>
</ul>
</dd>
</dl>
<p><strong>Store Raw Structure Data in HDF5 Groups</strong></p>
<p>Writes raw structure data as JSON strings into organized HDF5 groups with proper metadata and compression.</p>
<p><strong>Parameters:</strong></p>
<ul class="simple">
<li><p><strong>h5</strong> (<a class="reference external" href="https://docs.h5py.org/en/stable/high/file.html#h5py.File" title="(in h5py v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">h5py.File</span></code></a>) - Open HDF5 file with ‘/structures’ group</p></li>
<li><p><strong>refcode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) - CSD refcode identifier for the structure</p></li>
<li><p><strong>raw_json</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) - Serialized JSON string containing raw structure data</p></li>
</ul>
<p><strong>Group Organization:</strong></p>
<p>Creates or updates the structure: <code class="docutils literal notranslate"><span class="pre">/structures/&lt;refcode&gt;/raw_json</span></code></p>
<p><strong>Data Storage Features:</strong></p>
<ul class="simple">
<li><p><strong>Automatic replacement</strong> - Overwrites existing data if present</p></li>
<li><p><strong>UTF-8 encoding</strong> - Proper string encoding for international characters</p></li>
<li><p><strong>Compression</strong> - Applies file-level compression settings</p></li>
<li><p><strong>Metadata preservation</strong> - Maintains data provenance information</p></li>
</ul>
<p><strong>Usage Examples:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="c1"># Prepare structure data</span>
<span class="n">structure_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;identifier&#39;</span><span class="p">:</span> <span class="s1">&#39;ALANIN&#39;</span><span class="p">,</span>
    <span class="s1">&#39;cell_lengths&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">5.784</span><span class="p">,</span> <span class="mf">12.133</span><span class="p">,</span> <span class="mf">5.955</span><span class="p">],</span>
    <span class="s1">&#39;cell_angles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">,</span> <span class="mf">90.0</span><span class="p">],</span>
    <span class="s1">&#39;space_group&#39;</span><span class="p">:</span> <span class="s1">&#39;P n a 21&#39;</span><span class="p">,</span>
    <span class="s1">&#39;atoms&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;N1&#39;</span><span class="p">,</span> <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;coords&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]},</span>
        <span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;symbol&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;coords&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">]}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Serialize to JSON</span>
<span class="n">raw_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">structure_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Write to HDF5</span>
<span class="k">with</span> <span class="n">initialize_hdf5_file</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;structures.h5&quot;</span><span class="p">))</span> <span class="k">as</span> <span class="n">h5_file</span><span class="p">:</span>
    <span class="n">write_structure_group</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="s2">&quot;ALANIN&quot;</span><span class="p">,</span> <span class="n">raw_json</span><span class="p">)</span>

    <span class="c1"># Verify storage</span>
    <span class="n">stored_data</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;/structures/ALANIN/raw_json&#39;</span><span class="p">][()]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">restored_structure</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">stored_data</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stored structure: </span><span class="si">{</span><span class="n">restored_structure</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Batch Writing Pattern:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">write_multiple_structures</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">structure_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write multiple structures efficiently.&quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">refcode</span><span class="p">,</span> <span class="n">structure_data</span> <span class="ow">in</span> <span class="n">structure_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Serialize structure data</span>
        <span class="n">raw_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">structure_data</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">))</span>  <span class="c1"># Compact JSON</span>

        <span class="c1"># Write to HDF5</span>
        <span class="n">write_structure_group</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">refcode</span><span class="p">,</span> <span class="n">raw_json</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Stored </span><span class="si">{</span><span class="n">refcode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully stored </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structure_dict</span><span class="p">)</span><span class="si">}</span><span class="s2"> structures&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Error Handling and Validation:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">robust_structure_writing</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">refcode</span><span class="p">,</span> <span class="n">structure_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write structure data with validation and error handling.&quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Validate refcode</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">refcode</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">refcode</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid refcode: must be non-empty string&quot;</span><span class="p">)</span>

        <span class="c1"># Validate structure data</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structure_data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Structure data must be a dictionary&quot;</span><span class="p">)</span>

        <span class="c1"># Check for required fields</span>
        <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_lengths&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_angles&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">structure_data</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required field: </span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Serialize with error handling</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">raw_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">structure_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to serialize structure data: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Write to HDF5</span>
        <span class="n">write_structure_group</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">refcode</span><span class="p">,</span> <span class="n">raw_json</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error writing structure </span><span class="si">{</span><span class="n">refcode</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="advanced-hdf5-management">
<h2>Advanced HDF5 Management<a class="headerlink" href="#advanced-hdf5-management" title="Link to this heading"></a></h2>
<p><strong>File Metadata Management</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_file_metadata</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">metadata_dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add metadata to HDF5 file for provenance tracking.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>

    <span class="c1"># Create metadata group if it doesn&#39;t exist</span>
    <span class="k">if</span> <span class="s1">&#39;metadata&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_file</span><span class="p">:</span>
        <span class="n">meta_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;metadata&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">meta_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span>

    <span class="c1"># Add standard metadata</span>
    <span class="n">meta_group</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;creation_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
    <span class="n">meta_group</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;csa_version&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;csa_version&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
    <span class="n">meta_group</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;total_structures&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;total_structures&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">meta_group</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;processing_stage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stage&#39;</span><span class="p">,</span> <span class="s1">&#39;raw&#39;</span><span class="p">)</span>

    <span class="c1"># Add custom metadata</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metadata_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;creation_date&#39;</span><span class="p">,</span> <span class="s1">&#39;csa_version&#39;</span><span class="p">,</span> <span class="s1">&#39;total_structures&#39;</span><span class="p">,</span> <span class="s1">&#39;processing_stage&#39;</span><span class="p">]:</span>
            <span class="n">meta_group</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added metadata to HDF5 file: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="n">meta_group</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_file_metadata</span><span class="p">(</span><span class="n">h5_file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Read metadata from HDF5 file.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="s1">&#39;metadata&#39;</span> <span class="ow">in</span> <span class="n">h5_file</span><span class="p">:</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">metadata</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{}</span>
</pre></div>
</div>
<p><strong>Compression Optimization</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">optimize_hdf5_compression</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">,</span> <span class="n">compression_level</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Optimize HDF5 file compression settings.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">h5py</span>

    <span class="c1"># Define compression strategies for different data types</span>
    <span class="n">compression_strategies</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;float32&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;compression_opts&#39;</span><span class="p">:</span> <span class="n">compression_level</span><span class="p">,</span>
            <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;scaleoffset&#39;</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">},</span>
        <span class="s1">&#39;float64&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;compression_opts&#39;</span><span class="p">:</span> <span class="n">compression_level</span><span class="p">,</span>
            <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s1">&#39;scaleoffset&#39;</span><span class="p">:</span> <span class="mi">3</span>
        <span class="p">},</span>
        <span class="s1">&#39;int32&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;compression_opts&#39;</span><span class="p">:</span> <span class="n">compression_level</span><span class="p">,</span>
            <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">},</span>
        <span class="s1">&#39;string&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
            <span class="s1">&#39;compression_opts&#39;</span><span class="p">:</span> <span class="n">compression_level</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">compression_strategies</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_compressed_dataset</span><span class="p">(</span><span class="n">h5_group</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">dtype_hint</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create optimally compressed dataset.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="c1"># Determine data type</span>
    <span class="k">if</span> <span class="n">dtype_hint</span><span class="p">:</span>
        <span class="n">dtype_str</span> <span class="o">=</span> <span class="n">dtype_hint</span>
    <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;dtype&#39;</span><span class="p">):</span>
        <span class="n">dtype_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dtype_str</span> <span class="o">=</span> <span class="s1">&#39;string&#39;</span>

    <span class="c1"># Get compression settings</span>
    <span class="n">compression_opts</span> <span class="o">=</span> <span class="n">optimize_hdf5_compression</span><span class="p">(</span><span class="kc">None</span><span class="p">)[</span><span class="n">dtype_str</span><span class="p">]</span>

    <span class="c1"># Create dataset with optimal settings</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># Handle string data</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">h5_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">h5py</span><span class="o">.</span><span class="n">string_dtype</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),</span>
            <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">compression_opts</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="s1">&#39;scaleoffset&#39;</span><span class="p">}</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Handle numeric data</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="n">h5_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="o">**</span><span class="n">compression_opts</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset</span>
</pre></div>
</div>
<p><strong>File Integrity and Validation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">validate_hdf5_file</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate HDF5 file structure and integrity.&quot;&quot;&quot;</span>

    <span class="n">validation_report</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;is_valid&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;errors&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;warnings&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;structure_count&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;groups&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;file_size_mb&#39;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5_file</span><span class="p">:</span>
            <span class="c1"># Check file size</span>
            <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
            <span class="n">file_size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>
            <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;file_size_mb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">file_size</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

            <span class="c1"># Check required groups</span>
            <span class="k">if</span> <span class="s1">&#39;structures&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_file</span><span class="p">:</span>
                <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing required &#39;structures&#39; group&quot;</span><span class="p">)</span>
                <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">structures_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;structures&#39;</span><span class="p">]</span>
                <span class="n">structure_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">structures_group</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;structure_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">structure_keys</span><span class="p">)</span>
                <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;groups&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">structure_keys</span><span class="p">[:</span><span class="mi">10</span><span class="p">])</span>  <span class="c1"># First 10</span>

                <span class="c1"># Check individual structures</span>
                <span class="k">for</span> <span class="n">refcode</span> <span class="ow">in</span> <span class="n">structure_keys</span><span class="p">[:</span><span class="mi">10</span><span class="p">]:</span>  <span class="c1"># Sample validation</span>
                    <span class="n">structure_group</span> <span class="o">=</span> <span class="n">structures_group</span><span class="p">[</span><span class="n">refcode</span><span class="p">]</span>

                    <span class="k">if</span> <span class="s1">&#39;raw_json&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">structure_group</span><span class="p">:</span>
                        <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;warnings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Structure </span><span class="si">{</span><span class="n">refcode</span><span class="si">}</span><span class="s2"> missing raw_json&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="c1"># Try to decode JSON</span>
                            <span class="n">raw_data</span> <span class="o">=</span> <span class="n">structure_group</span><span class="p">[</span><span class="s1">&#39;raw_json&#39;</span><span class="p">][()]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
                            <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid JSON in </span><span class="si">{</span><span class="n">refcode</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                            <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Check metadata</span>
            <span class="k">if</span> <span class="s1">&#39;metadata&#39;</span> <span class="ow">in</span> <span class="n">h5_file</span><span class="p">:</span>
                <span class="n">metadata</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;creation_date&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
                    <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;warnings&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Missing creation_date in metadata&quot;</span><span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to open file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="n">validation_report</span>

<span class="k">def</span><span class="w"> </span><span class="nf">repair_hdf5_file</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Attempt to repair corrupted HDF5 file.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">backup</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
        <span class="n">backup_path</span> <span class="o">=</span> <span class="n">h5_file_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.h5.backup&#39;</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">,</span> <span class="n">backup_path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created backup: </span><span class="si">{</span><span class="n">backup_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Try to open and repack the file</span>
        <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5_in</span><span class="p">:</span>
            <span class="n">temp_path</span> <span class="o">=</span> <span class="n">h5_file_path</span><span class="o">.</span><span class="n">with_suffix</span><span class="p">(</span><span class="s1">&#39;.h5.temp&#39;</span><span class="p">)</span>

            <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">temp_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5_out</span><span class="p">:</span>
                <span class="c1"># Copy all accessible data</span>
                <span class="k">def</span><span class="w"> </span><span class="nf">copy_item</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">h5_in</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">h5_out</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to copy </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">False</span>

                <span class="n">h5_in</span><span class="o">.</span><span class="n">visititems</span><span class="p">(</span><span class="n">copy_item</span><span class="p">)</span>

        <span class="c1"># Replace original with repaired version</span>
        <span class="n">h5_file_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="n">temp_path</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully repaired </span><span class="si">{</span><span class="n">h5_file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to repair file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p><strong>File Organization Utilities</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">organize_hdf5_structure</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">organization_scheme</span><span class="o">=</span><span class="s1">&#39;by_space_group&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorganize HDF5 file structure for better access patterns.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">organization_scheme</span> <span class="o">==</span> <span class="s1">&#39;by_space_group&#39;</span><span class="p">:</span>
        <span class="n">organize_by_space_group</span><span class="p">(</span><span class="n">h5_file</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">organization_scheme</span> <span class="o">==</span> <span class="s1">&#39;by_composition&#39;</span><span class="p">:</span>
        <span class="n">organize_by_composition</span><span class="p">(</span><span class="n">h5_file</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">organization_scheme</span> <span class="o">==</span> <span class="s1">&#39;by_size&#39;</span><span class="p">:</span>
        <span class="n">organize_by_size</span><span class="p">(</span><span class="n">h5_file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown organization scheme: </span><span class="si">{</span><span class="n">organization_scheme</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">organize_by_space_group</span><span class="p">(</span><span class="n">h5_file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reorganize structures by space group.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="s1">&#39;structures&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_file</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">structures</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;structures&#39;</span><span class="p">]</span>
    <span class="n">space_group_map</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Collect structures by space group</span>
    <span class="k">for</span> <span class="n">refcode</span> <span class="ow">in</span> <span class="n">structures</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">raw_data</span> <span class="o">=</span> <span class="n">structures</span><span class="p">[</span><span class="n">refcode</span><span class="p">][</span><span class="s1">&#39;raw_json&#39;</span><span class="p">][()]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="n">structure_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
            <span class="n">space_group</span> <span class="o">=</span> <span class="n">structure_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;space_group&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">space_group</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">space_group_map</span><span class="p">:</span>
                <span class="n">space_group_map</span><span class="p">[</span><span class="n">space_group</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">space_group_map</span><span class="p">[</span><span class="n">space_group</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refcode</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not process </span><span class="si">{</span><span class="n">refcode</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create space group organization</span>
    <span class="k">if</span> <span class="s1">&#39;by_space_group&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">h5_file</span><span class="p">:</span>
        <span class="n">sg_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;by_space_group&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sg_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;by_space_group&#39;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">space_group</span><span class="p">,</span> <span class="n">refcodes</span> <span class="ow">in</span> <span class="n">space_group_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">sg_subgroup</span> <span class="o">=</span> <span class="n">sg_group</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">space_group</span><span class="p">)</span>
        <span class="n">sg_subgroup</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;structure_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">refcodes</span><span class="p">)</span>
        <span class="n">sg_subgroup</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;refcodes&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">refcodes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">h5py</span><span class="o">.</span><span class="n">string_dtype</span><span class="p">())</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Organized </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">structures</span><span class="p">)</span><span class="si">}</span><span class="s2"> structures into </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">space_group_map</span><span class="p">)</span><span class="si">}</span><span class="s2"> space groups&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="performance-optimization">
<h2>Performance Optimization<a class="headerlink" href="#performance-optimization" title="Link to this heading"></a></h2>
<p><strong>Chunking Strategies</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">calculate_optimal_chunks</span><span class="p">(</span><span class="n">data_shape</span><span class="p">,</span> <span class="n">target_chunk_size_mb</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate optimal chunk sizes for HDF5 datasets.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

    <span class="c1"># Estimate bytes per element</span>
    <span class="n">bytes_per_element</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Assume float32</span>
    <span class="n">total_elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span>
    <span class="n">total_size_mb</span> <span class="o">=</span> <span class="p">(</span><span class="n">total_elements</span> <span class="o">*</span> <span class="n">bytes_per_element</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">total_size_mb</span> <span class="o">&lt;=</span> <span class="n">target_chunk_size_mb</span><span class="p">:</span>
        <span class="c1"># Small dataset - no chunking needed</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># Calculate chunk dimensions</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">chunk_elements</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_chunk_size_mb</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">/</span> <span class="n">bytes_per_element</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">chunk_elements</span><span class="p">,</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),)</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># Chunk by rows</span>
        <span class="n">rows_per_chunk</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">target_chunk_size_mb</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">/</span> <span class="p">(</span><span class="n">data_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">bytes_per_element</span><span class="p">)))</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">rows_per_chunk</span><span class="p">,</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="c1"># Chunk by 2D slices</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Multi-dimensional - chunk first dimension</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">data_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_optimized_dataset</span><span class="p">(</span><span class="n">h5_group</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">chunk_size_mb</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create dataset with optimal chunking and compression.&quot;&quot;&quot;</span>

    <span class="c1"># Calculate optimal chunks</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="n">calculate_optimal_chunks</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">chunk_size_mb</span><span class="p">)</span>

    <span class="c1"># Create dataset with optimization</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">h5_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">chunks</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
        <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
        <span class="n">compression_opts</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">fletcher32</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">dataset</span>
</pre></div>
</div>
<p><strong>I/O Performance Monitoring</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">monitor_hdf5_performance</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Decorator to monitor HDF5 I/O performance.&quot;&quot;&quot;</span>

    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> completed in </span><span class="si">{</span><span class="n">duration</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@monitor_hdf5_performance</span>
<span class="k">def</span><span class="w"> </span><span class="nf">write_large_dataset</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write large dataset with performance monitoring.&quot;&quot;&quot;</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">create_optimized_dataset</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dataset</span>
</pre></div>
</div>
<p><strong>Memory Management</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">memory_efficient_hdf5_copy</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="n">dest_path</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Copy HDF5 file in chunks to manage memory usage.&quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">source_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5_source</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">dest_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">h5_dest</span><span class="p">:</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">copy_dataset_chunked</span><span class="p">(</span><span class="n">source_dataset</span><span class="p">,</span> <span class="n">dest_group</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;Copy dataset in chunks.&quot;&quot;&quot;</span>

                <span class="c1"># Create destination dataset</span>
                <span class="n">dest_dataset</span> <span class="o">=</span> <span class="n">dest_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">shape</span><span class="o">=</span><span class="n">source_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="n">source_dataset</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                    <span class="n">chunks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span>
                <span class="p">)</span>

                <span class="c1"># Copy data in chunks</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">source_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">source_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">chunk_size</span><span class="p">):</span>
                        <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">,</span> <span class="n">source_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">dest_dataset</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_dataset</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>

                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">source_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">start</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">source_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">chunk_size</span><span class="p">):</span>
                        <span class="n">end</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">,</span> <span class="n">source_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">dest_dataset</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">source_dataset</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">,</span> <span class="p">:]</span>

                <span class="c1"># Copy attributes</span>
                <span class="k">for</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">attr_value</span> <span class="ow">in</span> <span class="n">source_dataset</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">dest_dataset</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">attr_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">attr_value</span>

            <span class="c1"># Copy all groups and datasets</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">copy_item</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Group</span><span class="p">):</span>
                    <span class="n">h5_dest</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
                    <span class="n">group_name</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">dataset_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">group_name</span><span class="p">:</span>
                        <span class="n">dest_group</span> <span class="o">=</span> <span class="n">h5_dest</span><span class="p">[</span><span class="n">group_name</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">dest_group</span> <span class="o">=</span> <span class="n">h5_dest</span>

                    <span class="n">copy_dataset_chunked</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">dest_group</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">)</span>

            <span class="n">h5_source</span><span class="o">.</span><span class="n">visititems</span><span class="p">(</span><span class="n">copy_item</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="integration-examples">
<h2>Integration Examples<a class="headerlink" href="#integration-examples" title="Link to this heading"></a></h2>
<p><strong>Complete File Management Pipeline</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_and_populate_hdf5_file</span><span class="p">(</span><span class="n">structures_data</span><span class="p">,</span> <span class="n">output_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Complete pipeline for creating and populating HDF5 file.&quot;&quot;&quot;</span>

    <span class="c1"># Initialize file</span>
    <span class="n">h5_file</span> <span class="o">=</span> <span class="n">initialize_hdf5_file</span><span class="p">(</span><span class="n">output_path</span><span class="p">,</span> <span class="n">compression</span><span class="o">=</span><span class="s2">&quot;gzip&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Add metadata</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;csa_version&#39;</span><span class="p">:</span> <span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total_structures&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">structures_data</span><span class="p">),</span>
            <span class="s1">&#39;stage&#39;</span><span class="p">:</span> <span class="s1">&#39;raw_extraction&#39;</span><span class="p">,</span>
            <span class="s1">&#39;data_source&#39;</span><span class="p">:</span> <span class="s1">&#39;CSD_2024&#39;</span>
        <span class="p">}</span>
        <span class="n">add_file_metadata</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">metadata</span><span class="p">)</span>

        <span class="c1"># Write structures</span>
        <span class="n">successful_writes</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">failed_writes</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">refcode</span><span class="p">,</span> <span class="n">structure_data</span> <span class="ow">in</span> <span class="n">structures_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">raw_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">structure_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">write_structure_group</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">refcode</span><span class="p">,</span> <span class="n">raw_json</span><span class="p">)</span>
                <span class="n">successful_writes</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">failed_writes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">refcode</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>

        <span class="c1"># Update metadata with results</span>
        <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;successful_writes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">successful_writes</span>
        <span class="n">h5_file</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;failed_writes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">failed_writes</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully wrote </span><span class="si">{</span><span class="n">successful_writes</span><span class="si">}</span><span class="s2"> structures&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">failed_writes</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to write </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">failed_writes</span><span class="p">)</span><span class="si">}</span><span class="s2"> structures:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">refcode</span><span class="p">,</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">failed_writes</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Show first 5 errors</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">refcode</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">h5_file</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">raise</span> <span class="n">e</span>

<span class="k">def</span><span class="w"> </span><span class="nf">validate_and_repair_if_needed</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate HDF5 file and repair if necessary.&quot;&quot;&quot;</span>

    <span class="c1"># First, validate the file</span>
    <span class="n">validation_report</span> <span class="o">=</span> <span class="n">validate_hdf5_file</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Validation Report:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Valid: </span><span class="si">{</span><span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Structures: </span><span class="si">{</span><span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;structure_count&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  File size: </span><span class="si">{</span><span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;file_size_mb&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Errors:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;warnings&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Warnings:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">warning</span> <span class="ow">in</span> <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;warnings&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    - </span><span class="si">{</span><span class="n">warning</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Attempt repair if needed</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Attempting to repair file...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">repair_hdf5_file</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">):</span>
            <span class="c1"># Re-validate after repair</span>
            <span class="n">new_validation</span> <span class="o">=</span> <span class="n">validate_hdf5_file</span><span class="p">(</span><span class="n">h5_file_path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_validation</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;File successfully repaired and validated&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Repair attempt failed&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not repair file&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">validation_report</span><span class="p">[</span><span class="s1">&#39;is_valid&#39;</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="cross-references">
<h2>Cross-References<a class="headerlink" href="#cross-references" title="Link to this heading"></a></h2>
<p><strong>Related CSA Modules:</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="data_reader.html"><span class="doc">data_reader module</span></a> - Reading data from initialized HDF5 files</p></li>
<li><p><a class="reference internal" href="data_writer.html"><span class="doc">data_writer module</span></a> - Writing structured data to HDF5 files</p></li>
<li><p><span class="xref std std-doc">../io/dataset_initializer</span> - Creating dataset schemas in HDF5 files</p></li>
<li><p><a class="reference internal" href="../extraction/structure_data_extractor.html"><span class="doc">structure_data_extractor module</span></a> - Primary user of HDF5 utilities</p></li>
</ul>
<p><strong>External Dependencies:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.hdfgroup.org/solutions/hdf5/">HDF5</a> - Hierarchical data format library</p></li>
<li><p><a class="reference external" href="https://www.h5py.org/">h5py</a> - Python interface to HDF5</p></li>
<li><p><cite>pathlib</cite> - Path manipulation utilities</p></li>
</ul>
<p><strong>File Format Documentation:</strong></p>
<ul class="simple">
<li><p>HDF5 User Guide: <a class="reference external" href="https://docs.hdfgroup.org/hdf5/develop/_u_g.html">https://docs.hdfgroup.org/hdf5/develop/_u_g.html</a></p></li>
<li><p>HDF5 Best Practices: <a class="reference external" href="https://docs.hdfgroup.org/hdf5/develop/_best_practices.html">https://docs.hdfgroup.org/hdf5/develop/_best_practices.html</a></p></li>
<li><p>h5py Advanced Features: <a class="reference external" href="https://docs.h5py.org/en/stable/high/group.html">https://docs.h5py.org/en/stable/high/group.html</a></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="data_writer.html" class="btn btn-neutral float-left" title="data_writer module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dimension_scanner.html" class="btn btn-neutral float-right" title="dimension_scanner module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Nikolaos Galanakis .
      <span class="lastupdated">Last updated on Jul 01, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>