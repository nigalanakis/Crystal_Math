

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Performance Architecture &mdash; Crystal Structure Analysis (CSA) 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d6d662bc" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d6d662bc" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=51b770b3"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=9f22d18c"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../_static/custom.js?v=398222f2"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="structure_post_extraction_processor.BondParams" href="../api_reference/generated/structure_post_extraction_processor.BondParams.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="../index.html" class="icon icon-home">
            Crystal Structure Analysis (CSA)
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#quick-start-path-55-minutes">Quick Start Path (55 minutes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#detailed-learning-path">Detailed Learning Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#choose-your-starting-point">Choose Your Starting Point</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#what-you-ll-accomplish">What You’ll Accomplish</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#common-research-applications">Common Research Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#essential-next-steps">Essential Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#getting-help">Getting Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/index.html#ready-to-begin">Ready to Begin?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#system-requirements">System Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#step-1-install-python-and-prerequisites">Step 1: Install Python and Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#step-2-install-ccdc-software">Step 2: Install CCDC Software</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#step-3-install-csa">Step 3: Install CSA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#step-4-configure-csa">Step 4: Configure CSA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#step-5-gpu-setup-optional-but-recommended">Step 5: GPU Setup (Optional but Recommended)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#step-6-verify-installation">Step 6: Verify Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart Guide</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#the-five-stage-csa-pipeline">The Five-Stage CSA Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#step-1-create-your-configuration">Step 1: Create Your Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#step-2-run-your-first-analysis">Step 2: Run Your First Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#step-3-explore-your-results">Step 3: Explore Your Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#step-4-your-first-analysis">Step 4: Your First Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#step-5-understanding-your-results">Step 5: Understanding Your Results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#common-issues-and-solutions">Common Issues and Solutions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#next-steps-expanding-your-analysis">Next Steps: Expanding Your Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#congratulations">Congratulations!</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/quickstart.html#ready-for-more">Ready for More?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#quick-start-configuration">Quick Start Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#essential-parameters">Essential Parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#performance-settings">Performance Settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#common-configurations">Common Configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#creating-your-configuration">Creating Your Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#validation-and-testing">Validation and Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#common-beginner-mistakes">Common Beginner Mistakes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#getting-help">Getting Help</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#next-steps">Next Steps</a></li>
<li class="toctree-l4"><a class="reference internal" href="../getting_started/configuration.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#system-requirements">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#step-1-install-python-and-prerequisites">Step 1: Install Python and Prerequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#python-3-9-installation">Python 3.9 Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#step-2-install-ccdc-software">Step 2: Install CCDC Software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#csd-software-suite">CSD Software Suite</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#step-3-install-csa">Step 3: Install CSA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#download-csa">Download CSA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#create-virtual-environment">Create Virtual Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#install-dependencies">Install Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#step-4-configure-csa">Step 4: Configure CSA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#set-environment-variables">Set Environment Variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#step-5-gpu-setup-optional-but-recommended">Step 5: GPU Setup (Optional but Recommended)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#cuda-installation">CUDA Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#step-6-verify-installation">Step 6: Verify Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#quick-verification-script">Quick Verification Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#common-installation-issues">Common Installation Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/installation.html#getting-additional-help">Getting Additional Help</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#the-five-stage-csa-pipeline">The Five-Stage CSA Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#step-1-create-your-configuration">Step 1: Create Your Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#create-a-simple-configuration">Create a Simple Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#configuration-explained">Configuration Explained</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#step-2-run-your-first-analysis">Step 2: Run Your First Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#execute-the-pipeline">Execute the Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#monitor-progress">Monitor Progress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#understanding-the-stages">Understanding the Stages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#step-3-explore-your-results">Step 3: Explore Your Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#check-generated-files">Check Generated Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#quick-data-overview">Quick Data Overview</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#step-4-your-first-analysis">Step 4: Your First Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#crystal-property-analysis">Crystal Property Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#fragment-shape-analysis">Fragment Shape Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#step-5-understanding-your-results">Step 5: Understanding Your Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#what-you-ve-created">What You’ve Created</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#key-insights-from-your-data">Key Insights from Your Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#common-issues-and-solutions">Common Issues and Solutions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#no-structures-found">“No structures found”</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#out-of-memory-errors">“Out of memory” errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#very-slow-processing">“Very slow processing”</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#next-steps-expanding-your-analysis">Next Steps: Expanding Your Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#try-different-chemical-systems">Try Different Chemical Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#explore-advanced-features">Explore Advanced Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/quickstart.html#scale-up-your-research">Scale Up Your Research</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#congratulations">Congratulations!</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/quickstart.html#ready-for-more">Ready for More?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/configuration.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#quick-start-configuration">Quick Start Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#minimal-configuration">Minimal Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#complete-basic-configuration">Complete Basic Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#essential-parameters">Essential Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#required-settings">Required Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#pipeline-control">Pipeline Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#basic-filters">Basic Filters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#performance-settings">Performance Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#batch-sizes">Batch Sizes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#common-configurations">Common Configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#small-organic-molecules">Small Organic Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#drug-like-molecules">Drug-Like Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#quick-test-run">Quick Test Run</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#creating-your-configuration">Creating Your Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#step-by-step-process">Step-by-Step Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#validation-and-testing">Validation and Testing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#check-your-json">Check Your JSON</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#test-with-small-dataset">Test with Small Dataset</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#common-beginner-mistakes">Common Beginner Mistakes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#json-syntax-errors">JSON Syntax Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#configuration-issues">Configuration Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#getting-help">Getting Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/configuration.html#when-things-go-wrong">When Things Go Wrong</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#next-steps">Next Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/configuration.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/index.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#core-concepts">Core Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#essential-concepts">Essential Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#key-features-at-a-glance">Key Features at a Glance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#common-workflows">Common Workflows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#understanding-csa-s-approach">Understanding CSA’s Approach</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#scientific-foundation">Scientific Foundation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#technical-architecture">Technical Architecture</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#user-guide-sections">User Guide Sections</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#core-workflows">Core Workflows</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/pipeline_overview.html">Pipeline Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/data_model.html">Data Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/configuration.html">Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../user_guide/basic_analysis.html">Basic Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#advanced-techniques">Advanced Techniques</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#data-management">Data Management</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#performance-optimization">Performance Optimization</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#getting-the-most-from-csa">Getting the Most from CSA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#best-practices">Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#performance-tips">Performance Tips</a></li>
<li class="toctree-l3"><a class="reference internal" href="../user_guide/index.html#common-pitfalls">Common Pitfalls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user_guide/index.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#getting-started-tutorials">Getting Started Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#domain-specific-tutorials">Domain-Specific Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#advanced-analysis-tutorials">Advanced Analysis Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#specialized-workflows">Specialized Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#tutorial-structure">Tutorial Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#quick-start-recommendations">Quick Start Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#tutorial-downloads">Tutorial Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#tutorial-support">Tutorial Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#contributing-tutorials">Contributing Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#learning-paths">Learning Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#advanced-topics">Advanced Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#feedback-and-improvement">Feedback and Improvement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html#getting-help">Getting Help</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#quick-start-examples">Quick Start Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#data-access-examples">Data Access Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#analysis-examples">Analysis Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#visualization-examples">Visualization Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#performance-examples">Performance Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#example-categories">Example Categories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/index.html#basic-data-operations">Basic Data Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/index.html#advanced-workflows">Advanced Workflows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#configuration-templates">Configuration Templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/index.html#common-configuration-patterns">Common Configuration Patterns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/index.html#commonly-used-helper-functions">Commonly Used Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#interactive-examples">Interactive Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/index.html#jupyter-notebook-examples">Jupyter Notebook Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/index.html#command-line-examples">Command Line Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#troubleshooting-examples">Troubleshooting Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/index.html#common-issues-and-solutions">Common Issues and Solutions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#example-downloads">Example Downloads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/index.html#browse-examples-by-category">Browse Examples by Category</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/index.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html">crystal_analyzer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.extraction_config"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.extraction_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.csd_ops"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.csd_ops</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.extractor"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.extractor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.data_dir"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.data_dir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.__init__"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystal_analyzer.CrystalAnalyzer.extract_data"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer.extract_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#crystalanalyzer-class">CrystalAnalyzer Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#id0"><code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#methods">Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#extract-data">extract_data()</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#private-methods">Private Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#private-attributes">Private Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#configuration-dependencies">Configuration Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/crystal_analyzer.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/core/csa_config.html">csa_config module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.from_json"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.data_directory"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.data_directory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.data_prefix"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.data_prefix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.actions"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.actions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.filters"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.filters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.extraction_batch_size"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.extraction_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.post_extraction_batch_size"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.post_extraction_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#id0"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.ExtractionConfig.__init__"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#csa_config.load_config"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#configuration-management-for-csa-pipeline">Configuration Management for CSA Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#extractionconfig-class">ExtractionConfig Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#id1"><code class="docutils literal notranslate"><span class="pre">ExtractionConfig</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#configuration-loading-functions">Configuration Loading Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_config.html#id12"><code class="docutils literal notranslate"><span class="pre">load_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#configuration-validation">Configuration Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_config.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/core/csa_main.html">csa_main module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#csa_main.setup_logging"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#csa_main.parse_args"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#csa_main.run_extraction"><code class="docutils literal notranslate"><span class="pre">run_extraction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#csa_main.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#command-line-interface-for-csa-pipeline">Command-Line Interface for CSA Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#main-functions">Main Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_main.html#id0"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_main.html#id2"><code class="docutils literal notranslate"><span class="pre">run_extraction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#configuration-and-logging">Configuration and Logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_main.html#id3"><code class="docutils literal notranslate"><span class="pre">setup_logging()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/core/csa_main.html#id4"><code class="docutils literal notranslate"><span class="pre">parse_args()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#command-line-usage">Command-Line Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/core/csa_main.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/extraction/csd_operations.html">csd_operations module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.distance_tolerance"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.distance_tolerance</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.angle_tolerance"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.angle_tolerance</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_bond_types"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_bond_types</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_hydrogen_counts"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_hydrogen_counts</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_hydrogen_positions"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_hydrogen_positions</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.packing_shell_size"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.packing_shell_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.ignore_spacegroup"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.ignore_spacegroup</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.normalise_unit_cell"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.normalise_unit_cell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.SimilaritySettings.__init__"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings.__init__()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations"><code class="docutils literal notranslate"><span class="pre">CSDOperations</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.data_directory"><code class="docutils literal notranslate"><span class="pre">CSDOperations.data_directory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.data_prefix"><code class="docutils literal notranslate"><span class="pre">CSDOperations.data_prefix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.reader"><code class="docutils literal notranslate"><span class="pre">CSDOperations.reader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.similarity_engine"><code class="docutils literal notranslate"><span class="pre">CSDOperations.similarity_engine</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.__init__"><code class="docutils literal notranslate"><span class="pre">CSDOperations.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.get_refcode_families_df"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_refcode_families_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.save_refcode_families_csv"><code class="docutils literal notranslate"><span class="pre">CSDOperations.save_refcode_families_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.filter_families_by_size"><code class="docutils literal notranslate"><span class="pre">CSDOperations.filter_families_by_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.cluster_families"><code class="docutils literal notranslate"><span class="pre">CSDOperations.cluster_families()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations.get_unique_structures"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_unique_structures()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#cambridge-structural-database-operations">Cambridge Structural Database Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#similaritysettings-class">SimilaritySettings Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#id0"><code class="docutils literal notranslate"><span class="pre">SimilaritySettings</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csdoperations-class">CSDOperations Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#id11"><code class="docutils literal notranslate"><span class="pre">CSDOperations</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#family-extraction-methods">Family Extraction Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#id25"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_refcode_families_df()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#id26"><code class="docutils literal notranslate"><span class="pre">CSDOperations.save_refcode_families_csv()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#id27"><code class="docutils literal notranslate"><span class="pre">CSDOperations.filter_families_by_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#clustering-methods">Clustering Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#id28"><code class="docutils literal notranslate"><span class="pre">CSDOperations.cluster_families()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations._check_structure"><code class="docutils literal notranslate"><span class="pre">CSDOperations._check_structure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#representative-selection-methods">Representative Selection Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#id30"><code class="docutils literal notranslate"><span class="pre">CSDOperations.get_unique_structures()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations.CSDOperations._save_unique_structures"><code class="docutils literal notranslate"><span class="pre">CSDOperations._save_unique_structures()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#utility-functions">Utility Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations._process_single_family"><code class="docutils literal notranslate"><span class="pre">_process_single_family()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#csd_operations._representative_for_cluster"><code class="docutils literal notranslate"><span class="pre">_representative_for_cluster()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/csd_operations.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html">structure_data_extractor module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.hdf5_path"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.hdf5_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.filters"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.filters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.batch_size"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.reader"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.reader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.__init__"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor.StructureDataExtractor.run"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#raw-structure-data-extraction-pipeline">Raw Structure Data Extraction Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structuredataextractor-class">StructureDataExtractor Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#id0"><code class="docutils literal notranslate"><span class="pre">StructureDataExtractor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#data-extraction-functions">Data Extraction Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#structure_data_extractor._extract_one"><code class="docutils literal notranslate"><span class="pre">_extract_one()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#hdf5-data-organization">HDF5 Data Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#data-access-patterns">Data Access Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_data_extractor.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html">structure_post_extraction_processor module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams"><code class="docutils literal notranslate"><span class="pre">CrystalParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.cell_lengths"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.cell_angles"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id0"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id3"><code class="docutils literal notranslate"><span class="pre">CrystalParams.cell_angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.count"><code class="docutils literal notranslate"><span class="pre">CrystalParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.CrystalParams.index"><code class="docutils literal notranslate"><span class="pre">CrystalParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams"><code class="docutils literal notranslate"><span class="pre">AtomParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.labels"><code class="docutils literal notranslate"><span class="pre">AtomParams.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.symbols"><code class="docutils literal notranslate"><span class="pre">AtomParams.symbols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.coords"><code class="docutils literal notranslate"><span class="pre">AtomParams.coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.frac_coords"><code class="docutils literal notranslate"><span class="pre">AtomParams.frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.mask"><code class="docutils literal notranslate"><span class="pre">AtomParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.weights"><code class="docutils literal notranslate"><span class="pre">AtomParams.weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.charges"><code class="docutils literal notranslate"><span class="pre">AtomParams.charges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id4"><code class="docutils literal notranslate"><span class="pre">AtomParams.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id5"><code class="docutils literal notranslate"><span class="pre">AtomParams.symbols</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id6"><code class="docutils literal notranslate"><span class="pre">AtomParams.coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id7"><code class="docutils literal notranslate"><span class="pre">AtomParams.frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id8"><code class="docutils literal notranslate"><span class="pre">AtomParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id9"><code class="docutils literal notranslate"><span class="pre">AtomParams.weights</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id10"><code class="docutils literal notranslate"><span class="pre">AtomParams.charges</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.count"><code class="docutils literal notranslate"><span class="pre">AtomParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.AtomParams.index"><code class="docutils literal notranslate"><span class="pre">AtomParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams"><code class="docutils literal notranslate"><span class="pre">BondParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.atom1_idx"><code class="docutils literal notranslate"><span class="pre">BondParams.atom1_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.atom2_idx"><code class="docutils literal notranslate"><span class="pre">BondParams.atom2_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.bond_type"><code class="docutils literal notranslate"><span class="pre">BondParams.bond_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.is_rotatable_raw"><code class="docutils literal notranslate"><span class="pre">BondParams.is_rotatable_raw</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.is_cyclic"><code class="docutils literal notranslate"><span class="pre">BondParams.is_cyclic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.mask"><code class="docutils literal notranslate"><span class="pre">BondParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id11"><code class="docutils literal notranslate"><span class="pre">BondParams.atom1_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id12"><code class="docutils literal notranslate"><span class="pre">BondParams.atom2_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id13"><code class="docutils literal notranslate"><span class="pre">BondParams.bond_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id14"><code class="docutils literal notranslate"><span class="pre">BondParams.is_rotatable_raw</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id15"><code class="docutils literal notranslate"><span class="pre">BondParams.is_cyclic</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id16"><code class="docutils literal notranslate"><span class="pre">BondParams.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.count"><code class="docutils literal notranslate"><span class="pre">BondParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.BondParams.index"><code class="docutils literal notranslate"><span class="pre">BondParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams"><code class="docutils literal notranslate"><span class="pre">InterCCParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.central_atom"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.contact_atom"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.central_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.contact_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.central_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.contact_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.lengths"><code class="docutils literal notranslate"><span class="pre">InterCCParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.strengths"><code class="docutils literal notranslate"><span class="pre">InterCCParams.strengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.in_los"><code class="docutils literal notranslate"><span class="pre">InterCCParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_A"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_T"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_A_inv"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.symmetry_T_inv"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id17"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id18"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id19"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id20"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id21"><code class="docutils literal notranslate"><span class="pre">InterCCParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id22"><code class="docutils literal notranslate"><span class="pre">InterCCParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id23"><code class="docutils literal notranslate"><span class="pre">InterCCParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id24"><code class="docutils literal notranslate"><span class="pre">InterCCParams.strengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id25"><code class="docutils literal notranslate"><span class="pre">InterCCParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id26"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id27"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id28"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id29"><code class="docutils literal notranslate"><span class="pre">InterCCParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.count"><code class="docutils literal notranslate"><span class="pre">InterCCParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterCCParams.index"><code class="docutils literal notranslate"><span class="pre">InterCCParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams"><code class="docutils literal notranslate"><span class="pre">InterHBParams</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.central_atom"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.hydrogen_atom"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.contact_atom"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.central_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.hydrogen_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.contact_atom_idx"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.central_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.hydrogen_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.contact_atom_frac_coords"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.lengths"><code class="docutils literal notranslate"><span class="pre">InterHBParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.angles"><code class="docutils literal notranslate"><span class="pre">InterHBParams.angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.in_los"><code class="docutils literal notranslate"><span class="pre">InterHBParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_A"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_T"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_A_inv"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.symmetry_T_inv"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id30"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id31"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id32"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id33"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id34"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id35"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id36"><code class="docutils literal notranslate"><span class="pre">InterHBParams.central_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id37"><code class="docutils literal notranslate"><span class="pre">InterHBParams.hydrogen_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id38"><code class="docutils literal notranslate"><span class="pre">InterHBParams.contact_atom_frac_coords</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id39"><code class="docutils literal notranslate"><span class="pre">InterHBParams.lengths</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id40"><code class="docutils literal notranslate"><span class="pre">InterHBParams.angles</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id41"><code class="docutils literal notranslate"><span class="pre">InterHBParams.in_los</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id42"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id43"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id44"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_A_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id45"><code class="docutils literal notranslate"><span class="pre">InterHBParams.symmetry_T_inv</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.count"><code class="docutils literal notranslate"><span class="pre">InterHBParams.count()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.InterHBParams.index"><code class="docutils literal notranslate"><span class="pre">InterHBParams.index()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor.__init__"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor.run"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#advanced-feature-engineering-pipeline">Advanced Feature Engineering Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#data-structure-classes">Data Structure Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id46"><code class="docutils literal notranslate"><span class="pre">CrystalParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id53"><code class="docutils literal notranslate"><span class="pre">AtomParams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id70"><code class="docutils literal notranslate"><span class="pre">BondParams</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structurepostextractionprocessor-class">StructurePostExtractionProcessor Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#id85"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#fragment-analysis-methods">Fragment Analysis Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._compute_rigid_fragments"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._compute_rigid_fragments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#geometric-computation-methods">Geometric Computation Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._compute_fragment_com_centroid"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._compute_fragment_com_centroid()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#contact-analysis-methods">Contact Analysis Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._expand_inter_contacts"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._expand_inter_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._flag_hbond_contacts"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._flag_hbond_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._identify_contact_fragments"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._identify_contact_fragments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#advanced-feature-computation">Advanced Feature Computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#structure_post_extraction_processor.StructurePostExtractionProcessor._compute_contact_com_vectors"><code class="docutils literal notranslate"><span class="pre">StructurePostExtractionProcessor._compute_contact_com_vectors()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#data-writing-and-i-o-methods">Data Writing and I/O Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/extraction/structure_post_extraction_processor.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/processing/geometry_utils.html">geometry_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_distances_to_crystallographic_planes_frac_batch"><code class="docutils literal notranslate"><span class="pre">compute_distances_to_crystallographic_planes_frac_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_angles_between_bonds_and_crystallographic_planes_frac_batch"><code class="docutils literal notranslate"><span class="pre">compute_angles_between_bonds_and_crystallographic_planes_frac_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_atom_vectors_to_point_batch"><code class="docutils literal notranslate"><span class="pre">compute_atom_vectors_to_point_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_bond_rotatability_batch"><code class="docutils literal notranslate"><span class="pre">compute_bond_rotatability_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_bond_angles_batch"><code class="docutils literal notranslate"><span class="pre">compute_bond_angles_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_torsion_angles_batch"><code class="docutils literal notranslate"><span class="pre">compute_torsion_angles_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_quaternions_from_rotation_matrices"><code class="docutils literal notranslate"><span class="pre">compute_quaternions_from_rotation_matrices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_global_steinhardt_order_parameters_batch"><code class="docutils literal notranslate"><span class="pre">compute_global_steinhardt_order_parameters_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_best_fit_plane_batch"><code class="docutils literal notranslate"><span class="pre">compute_best_fit_plane_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_planarity_metrics_batch"><code class="docutils literal notranslate"><span class="pre">compute_planarity_metrics_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometry_utils.compute_fragment_pairwise_vectors_and_distances_batch"><code class="docutils literal notranslate"><span class="pre">compute_fragment_pairwise_vectors_and_distances_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#geometric-calculations-and-descriptors">Geometric Calculations and Descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#bond-angle-calculations">Bond Angle Calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#torsion-angle-calculations">Torsion Angle Calculations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#bond-rotatability-analysis">Bond Rotatability Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#planarity-analysis">Planarity Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#crystallographic-analysis">Crystallographic Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#order-parameter-analysis">Order Parameter Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#coordinate-transformations">Coordinate Transformations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#fragment-pairwise-analysis">Fragment Pairwise Analysis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/geometry_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/processing/fragment_utils.html">fragment_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#fragment_utils.identify_rigid_fragments_batch"><code class="docutils literal notranslate"><span class="pre">identify_rigid_fragments_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#fragment_utils.prepare_fragments_batch"><code class="docutils literal notranslate"><span class="pre">prepare_fragments_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#fragment_utils.compute_center_of_mass_batch"><code class="docutils literal notranslate"><span class="pre">compute_center_of_mass_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#fragment_utils.compute_centroid_batch"><code class="docutils literal notranslate"><span class="pre">compute_centroid_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#fragment_utils.compute_inertia_tensor_batch"><code class="docutils literal notranslate"><span class="pre">compute_inertia_tensor_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#fragment_utils.compute_quadrupole_tensor_batch"><code class="docutils literal notranslate"><span class="pre">compute_quadrupole_tensor_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#molecular-fragment-analysis-and-processing">Molecular Fragment Analysis and Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#fragment-identification">Fragment Identification</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">identify_rigid_fragments_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">prepare_fragments_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#center-calculations">Center Calculations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#id2"><code class="docutils literal notranslate"><span class="pre">compute_center_of_mass_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#id3"><code class="docutils literal notranslate"><span class="pre">compute_centroid_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#tensor-analysis">Tensor Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#id4"><code class="docutils literal notranslate"><span class="pre">compute_inertia_tensor_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#id5"><code class="docutils literal notranslate"><span class="pre">compute_quadrupole_tensor_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#shape-descriptors-and-analysis">Shape Descriptors and Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/fragment_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/processing/contact_utils.html">contact_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#contact_utils.compute_symmetric_contacts_batch"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_contacts_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#contact_utils.compute_symmetric_hbonds_batch"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_hbonds_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#contact_utils.compute_contact_is_hbond"><code class="docutils literal notranslate"><span class="pre">compute_contact_is_hbond()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#contact_utils.compute_contact_fragment_indices_batch"><code class="docutils literal notranslate"><span class="pre">compute_contact_fragment_indices_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#contact_utils.compute_contact_atom_to_central_fragment_com_batch"><code class="docutils literal notranslate"><span class="pre">compute_contact_atom_to_central_fragment_com_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#intermolecular-contact-analysis-and-symmetry-expansion">Intermolecular Contact Analysis and Symmetry Expansion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#core-contact-functions">Core Contact Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/contact_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_contacts_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#hydrogen-bond-analysis">Hydrogen Bond Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/contact_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">compute_symmetric_hbonds_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#contact-classification-and-validation">Contact Classification and Validation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/contact_utils.html#id2"><code class="docutils literal notranslate"><span class="pre">compute_contact_is_hbond()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#fragment-level-contact-analysis">Fragment-Level Contact Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/contact_utils.html#id3"><code class="docutils literal notranslate"><span class="pre">compute_contact_fragment_indices_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/contact_utils.html#id4"><code class="docutils literal notranslate"><span class="pre">compute_contact_atom_to_central_fragment_com_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#advanced-contact-analysis">Advanced Contact Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/contact_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/processing/cell_utils.html">cell_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#cell_utils.compute_scaled_cell"><code class="docutils literal notranslate"><span class="pre">compute_scaled_cell()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#cell_utils.compute_cell_matrix_batch"><code class="docutils literal notranslate"><span class="pre">compute_cell_matrix_batch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#crystallographic-unit-cell-transformations-and-matrix-operations">Crystallographic Unit Cell Transformations and Matrix Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/cell_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">compute_cell_matrix_batch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/cell_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">compute_scaled_cell()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#advanced-cell-operations">Advanced Cell Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/cell_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html">symmetry_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#symmetry_utils.parse_sym_op"><code class="docutils literal notranslate"><span class="pre">parse_sym_op()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#symmetry_utils.invert_sym_op"><code class="docutils literal notranslate"><span class="pre">invert_sym_op()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#symmetry_utils.add_symmetry_matrices"><code class="docutils literal notranslate"><span class="pre">add_symmetry_matrices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#symmetry_utils.add_inter_cc_symmetry"><code class="docutils literal notranslate"><span class="pre">add_inter_cc_symmetry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#symmetry_utils.add_inter_hb_symmetry"><code class="docutils literal notranslate"><span class="pre">add_inter_hb_symmetry()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#crystallographic-symmetry-operations-and-parsing">Crystallographic Symmetry Operations and Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">parse_sym_op()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">invert_sym_op()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#batch-symmetry-processing">Batch Symmetry Processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#id2"><code class="docutils literal notranslate"><span class="pre">add_symmetry_matrices()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#contact-specific-symmetry-functions">Contact-Specific Symmetry Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#id3"><code class="docutils literal notranslate"><span class="pre">add_inter_cc_symmetry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#id4"><code class="docutils literal notranslate"><span class="pre">add_inter_hb_symmetry()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#advanced-symmetry-analysis">Advanced Symmetry Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#error-handling-and-validation">Error Handling and Validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/processing/symmetry_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/io/data_reader.html">data_reader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader"><code class="docutils literal notranslate"><span class="pre">RawDataReader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.h5_in"><code class="docutils literal notranslate"><span class="pre">RawDataReader.h5_in</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.read_crystal_parameters"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_crystal_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.read_atoms"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.read_bonds"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.read_intermolecular_contacts"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.read_intermolecular_hbonds"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_hbonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.read_intramolecular_contacts"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.read_intramolecular_hbonds"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_hbonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#data_reader.RawDataReader.__init__"><code class="docutils literal notranslate"><span class="pre">RawDataReader.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id0"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_crystal_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id1"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_atoms()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id2"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_bonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id3"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id4"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_hbonds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id5"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id6"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_hbonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#hdf5-raw-data-reading-and-batch-loading">HDF5 Raw Data Reading and Batch Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#rawdatareader-class">RawDataReader Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id7"><code class="docutils literal notranslate"><span class="pre">RawDataReader</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#crystal-parameter-reading">Crystal Parameter Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id25"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_crystal_parameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#atomic-data-reading">Atomic Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id26"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_atoms()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#bond-data-reading">Bond Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id27"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_bonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#contact-data-reading">Contact Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id28"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id29"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intermolecular_hbonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#intramolecular-data-reading">Intramolecular Data Reading</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id30"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_contacts()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_reader.html#id31"><code class="docutils literal notranslate"><span class="pre">RawDataReader.read_intramolecular_hbonds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#advanced-usage-patterns">Advanced Usage Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#error-handling-and-diagnostics">Error Handling and Diagnostics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_reader.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/io/data_writer.html">data_writer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter"><code class="docutils literal notranslate"><span class="pre">RawDataWriter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter.h5_out"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.h5_out</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter.write_raw_crystal_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter.write_raw_atom_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter.write_raw_bond_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter.write_raw_intramolecular_contact_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter.write_raw_intramolecular_hbond_data"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_hbond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.RawDataWriter.__init__"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id0"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id1"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id2"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id3"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id4"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_hbond_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.h5_out"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.h5_out</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.write_computed_crystal_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.write_computed_atom_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.write_computed_bond_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.write_computed_molecule_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_molecule_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.write_computed_intermolecular_contact_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.write_computed_intermolecular_hbond_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_hbond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.__init__"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id5"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id6"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id7"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id8"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_molecule_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id9"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id10"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_intermolecular_hbond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#data_writer.ComputedDataWriter.write_computed_fragment_data"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_fragment_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#hdf5-data-writing-and-storage-management">HDF5 Data Writing and Storage Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#writer-classes-overview">Writer Classes Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#rawdatawriter-class">RawDataWriter Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id11"><code class="docutils literal notranslate"><span class="pre">RawDataWriter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#crystal-data-writing">Crystal Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id25"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_crystal_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#atomic-data-writing">Atomic Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id26"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_atom_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#bond-data-writing">Bond Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id27"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_bond_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#contact-data-writing">Contact Data Writing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id28"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_contact_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id29"><code class="docutils literal notranslate"><span class="pre">RawDataWriter.write_raw_intramolecular_hbond_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#computeddatawriter-class">ComputedDataWriter Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id30"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#computed-data-writing-methods">Computed Data Writing Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id47"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_crystal_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id48"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_atom_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id49"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_bond_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id50"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_molecule_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/data_writer.html#id51"><code class="docutils literal notranslate"><span class="pre">ComputedDataWriter.write_computed_fragment_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#advanced-writing-patterns">Advanced Writing Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#data-type-management">Data Type Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/data_writer.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/io/hdf5_utils.html">hdf5_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#hdf5_utils.initialize_hdf5_file"><code class="docutils literal notranslate"><span class="pre">initialize_hdf5_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#hdf5_utils.write_structure_group"><code class="docutils literal notranslate"><span class="pre">write_structure_group()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#hdf5-file-initialization-and-management-utilities">HDF5 File Initialization and Management Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#id0"><code class="docutils literal notranslate"><span class="pre">initialize_hdf5_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#id1"><code class="docutils literal notranslate"><span class="pre">write_structure_group()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#advanced-hdf5-management">Advanced HDF5 Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#performance-optimization">Performance Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#integration-examples">Integration Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/hdf5_utils.html#cross-references">Cross-References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/io/dimension_scanner.html">dimension_scanner module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/dimension_scanner.html#dependencies">Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/dimension_scanner.html#dimension_scanner.scan_max_dimensions"><code class="docutils literal notranslate"><span class="pre">scan_max_dimensions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/dimension_scanner.html#hdf5-dataset-dimension-analysis-and-optimization">HDF5 Dataset Dimension Analysis and Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/io/dimension_scanner.html#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/io/dimension_scanner.html#id0"><code class="docutils literal notranslate"><span class="pre">scan_max_dimensions()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#module-overview">Module Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#core-modules">Core Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#extraction-pipeline">Extraction Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#processing-utilities">Processing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#input-output">Input/Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#validation">Validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#quick-reference">Quick Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#most-common-classes">Most Common Classes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/crystal_analyzer.CrystalAnalyzer.html">crystal_analyzer.CrystalAnalyzer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/csa_config.ExtractionConfig.html">csa_config.ExtractionConfig</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/csd_operations.CSDOperations.html">csd_operations.CSDOperations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/structure_data_extractor.StructureDataExtractor.html">structure_data_extractor.StructureDataExtractor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/structure_post_extraction_processor.StructurePostExtractionProcessor.html">structure_post_extraction_processor.StructurePostExtractionProcessor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#key-functions">Key Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/csa_config.load_config.html">csa_config.load_config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/geometry_utils.compute_bond_angles_batch.html">geometry_utils.compute_bond_angles_batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/fragment_utils.identify_rigid_fragments_batch.html">fragment_utils.identify_rigid_fragments_batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/contact_utils.compute_symmetric_contacts_batch.html">contact_utils.compute_symmetric_contacts_batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/cell_utils.compute_cell_matrix_batch.html">cell_utils.compute_cell_matrix_batch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#data-structures">Data Structures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/csd_structure_validator.StructureValidationResult.html">csd_structure_validator.StructureValidationResult</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/structure_post_extraction_processor.CrystalParams.html">structure_post_extraction_processor.CrystalParams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/structure_post_extraction_processor.AtomParams.html">structure_post_extraction_processor.AtomParams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_reference/generated/structure_post_extraction_processor.BondParams.html">structure_post_extraction_processor.BondParams</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#usage-patterns">Usage Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#basic-pipeline-setup">Basic Pipeline Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#custom-processing">Custom Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#batch-geometric-calculations">Batch Geometric Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#data-access-patterns">Data Access Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#configuration-management">Configuration Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#error-handling-patterns">Error Handling Patterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api_reference/index.html#performance-optimization">Performance Optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#module-dependencies">Module Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#import-patterns">Import Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#common-workflows">Common Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#advanced-usage-examples">Advanced Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference/index.html#see-also">See Also</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Details</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performance Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data-storage-design">Data Storage Design</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#hdf5-schema-architecture">HDF5 Schema Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#algorithm-details">Algorithm Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#similarity-clustering-algorithm">Similarity Clustering Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="#geometric-calculation-algorithms">Geometric Calculation Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="#fragment-analysis-algorithms">Fragment Analysis Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="#contact-detection-algorithms">Contact Detection Algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#performance-optimization-details">Performance Optimization Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#gpu-memory-management">GPU Memory Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#testing-and-validation">Testing and Validation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#unit-testing-framework">Unit Testing Framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#documentation-and-maintenance">Documentation and Maintenance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#code-documentation-standards">Code Documentation Standards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#architecture-overview">Architecture Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#algorithms-and-methods">Algorithms and Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementation-details">Implementation Details</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-architecture">System Architecture</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#high-level-design">High-Level Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="#core-components">Core Components</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Crystal Structure Analysis (CSA)</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Performance Architecture</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/your-org/crystal-structure-analysis/blob/main/docs/source/technical_details/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <dl class="simple">
<dt><strong>Pipeline Orchestrator</strong> (<code class="docutils literal notranslate"><span class="pre">CrystalAnalyzer</span></code>)</dt><dd><ul class="simple">
<li><p>Coordinates execution of the five-stage pipeline</p></li>
<li><p>Manages resource allocation and error handling</p></li>
<li><p>Provides progress monitoring and checkpointing</p></li>
</ul>
</dd>
<dt><strong>Configuration Management</strong> (<code class="docutils literal notranslate"><span class="pre">ExtractionConfig</span></code>)</dt><dd><ul class="simple">
<li><p>Validates and normalizes configuration parameters</p></li>
<li><p>Handles parameter inheritance and defaults</p></li>
<li><p>Supports environment-specific overrides</p></li>
</ul>
</dd>
<dt><strong>Data Extraction Pipeline</strong></dt><dd><ul class="simple">
<li><p>Stage 1: CSD querying and family extraction</p></li>
<li><p>Stage 2: Packing similarity clustering</p></li>
<li><p>Stage 3: Representative structure selection</p></li>
<li><p>Stage 4: Atomic data extraction and storage</p></li>
<li><p>Stage 5: Feature engineering and descriptor calculation</p></li>
</ul>
</dd>
<dt><strong>Storage Layer</strong> (HDF5-based)</dt><dd><ul class="simple">
<li><p>Variable-length datasets for ragged arrays</p></li>
<li><p>Efficient compression and chunking</p></li>
<li><p>Metadata management and versioning</p></li>
</ul>
</dd>
</dl>
<section id="performance-architecture">
<h1>Performance Architecture<a class="headerlink" href="#performance-architecture" title="Link to this heading"></a></h1>
<p><strong>GPU Acceleration Strategy</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>CPU Tasks                    GPU Tasks
├── File I/O                 ├── Tensor Operations
├── CSD Queries              ├── Distance Calculations
├── Data Validation          ├── Matrix Operations
├── Configuration            ├── Similarity Metrics
└── Result Aggregation       └── Batch Processing
</pre></div>
</div>
<p><strong>Memory Management</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Memory hierarchy optimization</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MemoryManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manages memory allocation across CPU and GPU.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpu_fraction</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpu_memory_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_gpu_memory</span><span class="p">()</span> <span class="o">*</span> <span class="n">gpu_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cpu_memory_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_cpu_memory</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.7</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">allocate_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">structure_complexity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dynamic batch size adjustment based on memory constraints.&quot;&quot;&quot;</span>
        <span class="n">estimated_gpu_usage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_gpu_memory</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">structure_complexity</span><span class="p">)</span>
        <span class="n">estimated_cpu_usage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_estimate_cpu_memory</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">structure_complexity</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">estimated_gpu_usage</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpu_memory_limit</span><span class="p">:</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reduce_batch_size</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="s1">&#39;gpu&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">estimated_cpu_usage</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cpu_memory_limit</span><span class="p">:</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reduce_batch_size</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">batch_size</span>
</pre></div>
</div>
<p><strong>Parallel Processing Design</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Multi-level parallelization</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_structures_parallel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure_batch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements nested parallelization:</span>
<span class="sd">    - Process-level: Multiple structures in parallel</span>
<span class="sd">    - Thread-level: I/O operations</span>
<span class="sd">    - GPU-level: Tensor operations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">ProcessPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_processes</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="c1"># Process-level parallelization</span>
        <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">structure_group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chunk_structures</span><span class="p">(</span><span class="n">structure_batch</span><span class="p">):</span>
            <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_process_structure_group</span><span class="p">,</span> <span class="n">structure_group</span><span class="p">)</span>
            <span class="n">futures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

        <span class="c1"># Collect results</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
            <span class="n">results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>

    <span class="k">return</span> <span class="n">results</span>
</pre></div>
</div>
<section id="data-storage-design">
<h2>Data Storage Design<a class="headerlink" href="#data-storage-design" title="Link to this heading"></a></h2>
</section>
</section>
<section id="hdf5-schema-architecture">
<h1>HDF5 Schema Architecture<a class="headerlink" href="#hdf5-schema-architecture" title="Link to this heading"></a></h1>
<p><strong>Hierarchical Organization</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>analysis_processed.h5
├── /metadata
│   ├── version_info
│   ├── creation_timestamp
│   ├── configuration_hash
│   └── dataset_statistics
│
├── /structure_identifiers
│   └── refcode_list (N,) vlen&lt;string&gt;
│
├── /crystal_properties
│   ├── z_prime (N,) int32
│   ├── cell_volume (N,) float32
│   ├── cell_matrix (N,3,3) float32
│   └── space_group (N,) vlen&lt;string&gt;
│
├── /atomic_data
│   ├── n_atoms (N,) int32
│   ├── atom_coords (N,) vlen&lt;float32&gt;
│   ├── atom_symbols (N,) vlen&lt;string&gt;
│   └── atom_fragment_id (N,) vlen&lt;int32&gt;
│
├── /molecular_features
│   ├── n_fragments (N,) int32
│   ├── fragment_com_coords (N,) vlen&lt;float32&gt;
│   ├── fragment_inertia_eigvals (N,) vlen&lt;float32&gt;
│   └── fragment_formula (N,) vlen&lt;string&gt;
│
└── /interaction_data
    ├── inter_cc_n_contacts (N,) int32
    ├── inter_cc_central_atom (N,) vlen&lt;string&gt;
    ├── inter_cc_length (N,) vlen&lt;float32&gt;
    └── inter_hb_is_hbond (N,) vlen&lt;bool&gt;
</pre></div>
</div>
<p><strong>Variable-Length Array Implementation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Efficient storage of ragged arrays</span>
<span class="k">class</span><span class="w"> </span><span class="nc">VariableLengthDataset</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handles variable-length data with optimal storage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5_group</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vlen_dtype</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">vlen_dtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span> <span class="o">=</span> <span class="n">h5_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
            <span class="n">dataset_name</span><span class="p">,</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,),</span>
            <span class="n">maxshape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,),</span>
            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vlen_dtype</span><span class="p">,</span>
            <span class="n">chunks</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;lz4&#39;</span><span class="p">,</span>
            <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">fletcher32</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append_batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_batch</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Efficiently append batch of variable-length arrays.&quot;&quot;&quot;</span>
        <span class="n">current_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">new_size</span> <span class="o">=</span> <span class="n">current_size</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_batch</span><span class="p">)</span>

        <span class="c1"># Resize dataset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">new_size</span><span class="p">,))</span>

        <span class="c1"># Write data</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_batch</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="n">current_size</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Compression and Optimization</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Storage optimization strategies</span>
<span class="n">COMPRESSION_SETTINGS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;coordinates&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;lz4&#39;</span><span class="p">,</span>
        <span class="s1">&#39;compression_opts&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;chunks&#39;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">},</span>
    <span class="s1">&#39;identifiers&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;gzip&#39;</span><span class="p">,</span>
        <span class="s1">&#39;compression_opts&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;chunks&#39;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">},</span>
    <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;compression&#39;</span><span class="p">:</span> <span class="s1">&#39;lz4&#39;</span><span class="p">,</span>
        <span class="s1">&#39;compression_opts&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;chunks&#39;</span><span class="p">:</span> <span class="kc">True</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<section id="algorithm-details">
<h2>Algorithm Details<a class="headerlink" href="#algorithm-details" title="Link to this heading"></a></h2>
</section>
</section>
<section id="similarity-clustering-algorithm">
<h1>Similarity Clustering Algorithm<a class="headerlink" href="#similarity-clustering-algorithm" title="Link to this heading"></a></h1>
<p><strong>Packing Similarity Calculation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_packing_similarity_batch</span><span class="p">(</span>
        <span class="n">coords_batch</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>      <span class="c1"># (B, N, 3)</span>
        <span class="n">cell_matrices_batch</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>  <span class="c1"># (B, 3, 3)</span>
        <span class="n">similarity_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute 3D packing similarity using CCDC algorithms.</span>

<span class="sd">    Implementation of the packing similarity metric used by</span>
<span class="sd">    the Cambridge Crystallographic Data Centre.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">coords_batch</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">coords_batch</span><span class="o">.</span><span class="n">device</span>

    <span class="c1"># 1. Generate symmetry-related coordinates</span>
    <span class="n">symmetry_coords</span> <span class="o">=</span> <span class="n">generate_symmetry_coordinates</span><span class="p">(</span>
        <span class="n">coords_batch</span><span class="p">,</span> <span class="n">cell_matrices_batch</span>
    <span class="p">)</span>

    <span class="c1"># 2. Compute optimal alignment between structures</span>
    <span class="n">similarity_matrix</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
            <span class="c1"># Find best alignment using Kabsch algorithm</span>
            <span class="n">rotation</span><span class="p">,</span> <span class="n">translation</span> <span class="o">=</span> <span class="n">kabsch_alignment</span><span class="p">(</span>
                <span class="n">coords_batch</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coords_batch</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="c1"># Apply transformation and compute RMSD</span>
            <span class="n">aligned_coords</span> <span class="o">=</span> <span class="n">apply_transformation</span><span class="p">(</span>
                <span class="n">coords_batch</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">rotation</span><span class="p">,</span> <span class="n">translation</span>
            <span class="p">)</span>

            <span class="n">rmsd</span> <span class="o">=</span> <span class="n">compute_rmsd</span><span class="p">(</span><span class="n">coords_batch</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">aligned_coords</span><span class="p">)</span>
            <span class="n">similarity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rmsd</span> <span class="o">/</span> <span class="n">similarity_threshold</span><span class="p">)</span>

            <span class="n">similarity_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">similarity</span>
            <span class="n">similarity_matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">similarity</span>

    <span class="k">return</span> <span class="n">similarity_matrix</span>
</pre></div>
</div>
<p><strong>Clustering Implementation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">cluster_similar_structures</span><span class="p">(</span>
        <span class="n">similarity_matrix</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;hierarchical&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cluster structures based on packing similarity.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;hierarchical&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">hierarchical_clustering</span><span class="p">(</span><span class="n">similarity_matrix</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;graph_based&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">graph_clustering</span><span class="p">(</span><span class="n">similarity_matrix</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown clustering method: </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">hierarchical_clustering</span><span class="p">(</span><span class="n">similarity_matrix</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Agglomerative clustering with similarity threshold.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.cluster.hierarchy</span><span class="w"> </span><span class="kn">import</span> <span class="n">linkage</span><span class="p">,</span> <span class="n">fcluster</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial.distance</span><span class="w"> </span><span class="kn">import</span> <span class="n">squareform</span>

    <span class="c1"># Convert similarity to distance</span>
    <span class="n">distance_matrix</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">similarity_matrix</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
    <span class="n">condensed_distances</span> <span class="o">=</span> <span class="n">squareform</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

    <span class="c1"># Perform clustering</span>
    <span class="n">linkage_matrix</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">condensed_distances</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;average&#39;</span><span class="p">)</span>
    <span class="n">clusters</span> <span class="o">=</span> <span class="n">fcluster</span><span class="p">(</span><span class="n">linkage_matrix</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span>

    <span class="c1"># Group by cluster</span>
    <span class="n">cluster_groups</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">cluster_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">clusters</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cluster_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cluster_groups</span><span class="p">:</span>
            <span class="n">cluster_groups</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cluster_groups</span><span class="p">[</span><span class="n">cluster_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">cluster_groups</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="geometric-calculation-algorithms">
<h1>Geometric Calculation Algorithms<a class="headerlink" href="#geometric-calculation-algorithms" title="Link to this heading"></a></h1>
<p><strong>Distance Calculations with Periodic Boundaries</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_distances_periodic_batch</span><span class="p">(</span>
        <span class="n">coords1</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>  <span class="c1"># (B, N1, 3)</span>
        <span class="n">coords2</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>  <span class="c1"># (B, N2, 3)</span>
        <span class="n">cell_matrices</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>  <span class="c1"># (B, 3, 3)</span>
        <span class="n">use_minimum_image</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute distances with periodic boundary conditions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span><span class="p">,</span> <span class="n">N1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">coords1</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">N2</span> <span class="o">=</span> <span class="n">coords2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">coords1</span><span class="o">.</span><span class="n">device</span>

    <span class="c1"># Vectorized distance calculation</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">coords1</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">coords2</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (B, N1, N2, 3)</span>

    <span class="k">if</span> <span class="n">use_minimum_image</span><span class="p">:</span>
        <span class="c1"># Apply minimum image convention</span>
        <span class="n">fractional_diff</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
            <span class="n">diff</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">cell_matrices</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Wrap to [-0.5, 0.5]</span>
        <span class="n">fractional_diff</span> <span class="o">=</span> <span class="n">fractional_diff</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">fractional_diff</span><span class="p">)</span>

        <span class="c1"># Convert back to Cartesian</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">fractional_diff</span><span class="p">,</span> <span class="n">cell_matrices</span><span class="p">)</span>

    <span class="n">distances</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (B, N1, N2)</span>
    <span class="k">return</span> <span class="n">distances</span>
</pre></div>
</div>
<p><strong>Inertia Tensor Calculation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_inertia_tensor_batch</span><span class="p">(</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>     <span class="c1"># (B, N, 3)</span>
        <span class="n">masses</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>     <span class="c1"># (B, N)</span>
        <span class="n">com</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>        <span class="c1"># (B, 3)</span>
        <span class="n">atom_mask</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">BoolTensor</span>  <span class="c1"># (B, N)</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute inertia tensor eigenvalues and eigenvectors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">device</span>

    <span class="c1"># Center coordinates at COM</span>
    <span class="n">centered_coords</span> <span class="o">=</span> <span class="n">coords</span> <span class="o">-</span> <span class="n">com</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (B, N, 3)</span>

    <span class="c1"># Apply mask</span>
    <span class="n">centered_coords</span> <span class="o">=</span> <span class="n">centered_coords</span> <span class="o">*</span> <span class="n">atom_mask</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
    <span class="n">masses_masked</span> <span class="o">=</span> <span class="n">masses</span> <span class="o">*</span> <span class="n">atom_mask</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>

    <span class="c1"># Compute inertia tensor components</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">centered_coords</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Each (B, N)</span>

    <span class="n">Ixx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses_masked</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (B,)</span>
    <span class="n">Iyy</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses_masked</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Izz</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses_masked</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Ixy</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses_masked</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Ixz</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses_masked</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">z</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">Iyz</span> <span class="o">=</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">masses_masked</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">z</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Construct inertia tensor matrix</span>
    <span class="n">I_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ixx</span>
    <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Iyy</span>
    <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Izz</span>
    <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ixy</span>
    <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ixz</span>
    <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">I_tensor</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Iyz</span>

    <span class="c1"># Compute eigenvalues and eigenvectors</span>
    <span class="n">eigenvals</span><span class="p">,</span> <span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">I_tensor</span><span class="p">)</span>

    <span class="c1"># Sort by eigenvalue magnitude</span>
    <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">eigenvals</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eigenvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">eigenvals</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sort_indices</span><span class="p">)</span>
    <span class="n">eigenvecs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span>
        <span class="n">eigenvecs</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sort_indices</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">eigenvals</span><span class="p">,</span> <span class="n">eigenvecs</span>
</pre></div>
</div>
</section>
<section id="fragment-analysis-algorithms">
<h1>Fragment Analysis Algorithms<a class="headerlink" href="#fragment-analysis-algorithms" title="Link to this heading"></a></h1>
<p><strong>Rigid Fragment Identification</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">identify_rigid_fragments_batch</span><span class="p">(</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>         <span class="c1"># (B, N, 3)</span>
        <span class="n">bond_indices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span>  <span class="c1"># List of (E_i, 2) for each structure</span>
        <span class="n">flexibility_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">15.0</span>  <span class="c1"># degrees</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Identify rigid molecular fragments based on bond flexibility.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fragments_batch</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">bond_idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bond_indices</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bond_idx</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fragments_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">continue</span>

        <span class="c1"># Build molecular graph</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">build_molecular_graph</span><span class="p">(</span><span class="n">bond_idx</span><span class="p">)</span>

        <span class="c1"># Identify rotatable bonds</span>
        <span class="n">rotatable_bonds</span> <span class="o">=</span> <span class="n">identify_rotatable_bonds</span><span class="p">(</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">bond_idx</span><span class="p">,</span> <span class="n">flexibility_threshold</span>
        <span class="p">)</span>

        <span class="c1"># Remove rotatable bonds to get rigid fragments</span>
        <span class="n">rigid_graph</span> <span class="o">=</span> <span class="n">remove_bonds</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">rotatable_bonds</span><span class="p">)</span>

        <span class="c1"># Find connected components (rigid fragments)</span>
        <span class="n">fragments</span> <span class="o">=</span> <span class="n">find_connected_components</span><span class="p">(</span><span class="n">rigid_graph</span><span class="p">)</span>
        <span class="n">fragments_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fragments</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fragments_batch</span>
</pre></div>
</div>
<p><strong>Fragment Property Calculation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_fragment_properties_batch</span><span class="p">(</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>     <span class="c1"># (B, N, 3)</span>
        <span class="n">masses</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>     <span class="c1"># (B, N)</span>
        <span class="n">fragments</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]],</span>  <span class="c1"># Fragment assignments</span>
        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute comprehensive fragment properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">max_fragments</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">frags</span><span class="p">)</span> <span class="k">for</span> <span class="n">frags</span> <span class="ow">in</span> <span class="n">fragments</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fragments</span><span class="p">)</span>

    <span class="c1"># Initialize output tensors</span>
    <span class="n">com_coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="n">max_fragments</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">inertia_eigvals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="n">max_fragments</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">inertia_eigvecs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="n">max_fragments</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">planarity_scores</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">B</span><span class="p">,</span> <span class="n">max_fragments</span><span class="p">),</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fragment_list</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fragments</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">fragment_atoms</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fragment_list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fragment_atoms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># Fragment coordinates and masses</span>
            <span class="n">frag_coords</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">fragment_atoms</span><span class="p">]</span>  <span class="c1"># (n_atoms, 3)</span>
            <span class="n">frag_masses</span> <span class="o">=</span> <span class="n">masses</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">fragment_atoms</span><span class="p">]</span>  <span class="c1"># (n_atoms,)</span>

            <span class="c1"># Center of mass</span>
            <span class="n">total_mass</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frag_masses</span><span class="p">)</span>
            <span class="n">com</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">frag_coords</span> <span class="o">*</span> <span class="n">frag_masses</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_mass</span>
            <span class="n">com_coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">com</span>

            <span class="c1"># Inertia tensor</span>
            <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">compute_inertia_tensor_single</span><span class="p">(</span>
                <span class="n">frag_coords</span><span class="p">,</span> <span class="n">frag_masses</span><span class="p">,</span> <span class="n">com</span>
            <span class="p">)</span>
            <span class="n">inertia_eigvals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigvals</span>
            <span class="n">inertia_eigvecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigvecs</span>

            <span class="c1"># Planarity score</span>
            <span class="n">planarity</span> <span class="o">=</span> <span class="n">compute_planarity_score</span><span class="p">(</span><span class="n">frag_coords</span><span class="p">,</span> <span class="n">com</span><span class="p">)</span>
            <span class="n">planarity_scores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">planarity</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;com_coords&#39;</span><span class="p">:</span> <span class="n">com_coords</span><span class="p">,</span>
        <span class="s1">&#39;inertia_eigvals&#39;</span><span class="p">:</span> <span class="n">inertia_eigvals</span><span class="p">,</span>
        <span class="s1">&#39;inertia_eigvecs&#39;</span><span class="p">:</span> <span class="n">inertia_eigvecs</span><span class="p">,</span>
        <span class="s1">&#39;planarity_scores&#39;</span><span class="p">:</span> <span class="n">planarity_scores</span>
    <span class="p">}</span>
</pre></div>
</div>
</section>
<section id="contact-detection-algorithms">
<h1>Contact Detection Algorithms<a class="headerlink" href="#contact-detection-algorithms" title="Link to this heading"></a></h1>
<p><strong>Intermolecular Contact Identification</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">detect_intermolecular_contacts_batch</span><span class="p">(</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>           <span class="c1"># (B, N, 3)</span>
        <span class="n">cell_matrices</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>    <span class="c1"># (B, 3, 3)</span>
        <span class="n">van_der_waals_radii</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>  <span class="c1"># (B, N)</span>
        <span class="n">contact_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.2</span>  <span class="c1"># Factor of sum of vdW radii</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Detect intermolecular contacts using symmetry operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">contacts_batch</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
        <span class="n">structure_coords</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># (N, 3)</span>
        <span class="n">cell_matrix</span> <span class="o">=</span> <span class="n">cell_matrices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># (3, 3)</span>
        <span class="n">vdw_radii</span> <span class="o">=</span> <span class="n">van_der_waals_radii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># (N,)</span>

        <span class="c1"># Generate symmetry-related images</span>
        <span class="n">symmetry_coords</span> <span class="o">=</span> <span class="n">generate_symmetry_images</span><span class="p">(</span>
            <span class="n">structure_coords</span><span class="p">,</span> <span class="n">cell_matrix</span>
        <span class="p">)</span>

        <span class="n">contacts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Check contacts between central molecule and symmetry images</span>
        <span class="k">for</span> <span class="n">sym_idx</span><span class="p">,</span> <span class="n">sym_coords</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">symmetry_coords</span><span class="p">):</span>
            <span class="n">distances</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">structure_coords</span><span class="p">,</span> <span class="n">sym_coords</span><span class="p">)</span>  <span class="c1"># (N, N)</span>

            <span class="c1"># Contact criteria</span>
            <span class="n">vdw_sum</span> <span class="o">=</span> <span class="n">vdw_radii</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">vdw_radii</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># (N, N)</span>
            <span class="n">contact_distances</span> <span class="o">=</span> <span class="n">vdw_sum</span> <span class="o">*</span> <span class="n">contact_threshold</span>

            <span class="n">contact_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">distances</span> <span class="o">&lt;</span> <span class="n">contact_distances</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">distances</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span>
            <span class="n">contact_pairs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">contact_mask</span><span class="p">,</span> <span class="n">as_tuple</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">contact_pairs</span><span class="p">:</span>
                <span class="n">central_atom</span><span class="p">,</span> <span class="n">contact_atom</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
                <span class="n">distance</span> <span class="o">=</span> <span class="n">distances</span><span class="p">[</span><span class="n">central_atom</span><span class="p">,</span> <span class="n">contact_atom</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

                <span class="n">contacts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;central_atom&#39;</span><span class="p">:</span> <span class="n">central_atom</span><span class="p">,</span>
                    <span class="s1">&#39;contact_atom&#39;</span><span class="p">:</span> <span class="n">contact_atom</span><span class="p">,</span>
                    <span class="s1">&#39;distance&#39;</span><span class="p">:</span> <span class="n">distance</span><span class="p">,</span>
                    <span class="s1">&#39;symmetry_operation&#39;</span><span class="p">:</span> <span class="n">sym_idx</span><span class="p">,</span>
                    <span class="s1">&#39;is_hbond&#39;</span><span class="p">:</span> <span class="n">classify_hydrogen_bond</span><span class="p">(</span>
                        <span class="n">structure_coords</span><span class="p">[</span><span class="n">central_atom</span><span class="p">],</span>
                        <span class="n">sym_coords</span><span class="p">[</span><span class="n">contact_atom</span><span class="p">],</span>
                        <span class="n">distance</span>
                    <span class="p">)</span>
                <span class="p">})</span>

        <span class="n">contacts_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">contacts</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">contacts_batch</span>
</pre></div>
</div>
<p><strong>Hydrogen Bond Classification</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">classify_hydrogen_bond</span><span class="p">(</span>
        <span class="n">donor_coord</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>    <span class="c1"># (3,)</span>
        <span class="n">acceptor_coord</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="c1"># (3,)</span>
        <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">donor_element</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">acceptor_element</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">hydrogen_coord</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># (3,) optional</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Classify whether a contact is a hydrogen bond.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Distance criteria</span>
    <span class="k">if</span> <span class="n">distance</span> <span class="o">&gt;</span> <span class="mf">3.5</span><span class="p">:</span>  <span class="c1"># Å</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Element criteria</span>
    <span class="n">hbond_donors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">}</span>
    <span class="n">hbond_acceptors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">donor_element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hbond_donors</span> <span class="ow">or</span> <span class="n">acceptor_element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hbond_acceptors</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Angle criteria (if hydrogen position available)</span>
    <span class="k">if</span> <span class="n">hydrogen_coord</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dha_angle</span> <span class="o">=</span> <span class="n">compute_angle</span><span class="p">(</span><span class="n">donor_coord</span><span class="p">,</span> <span class="n">hydrogen_coord</span><span class="p">,</span> <span class="n">acceptor_coord</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dha_angle</span> <span class="o">&lt;</span> <span class="mf">120.0</span><span class="p">:</span>  <span class="c1"># degrees</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
<section id="performance-optimization-details">
<h2>Performance Optimization Details<a class="headerlink" href="#performance-optimization-details" title="Link to this heading"></a></h2>
</section>
</section>
<section id="gpu-memory-management">
<h1>GPU Memory Management<a class="headerlink" href="#gpu-memory-management" title="Link to this heading"></a></h1>
<p><strong>Dynamic Memory Allocation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">GPUMemoryManager</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Intelligent GPU memory management for batch processing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reserved_fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_memory</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">get_device_properties</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">total_memory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reserved_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_memory</span> <span class="o">*</span> <span class="n">reserved_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">available_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_memory</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">reserved_memory</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">estimate_batch_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">avg_atoms</span><span class="p">,</span> <span class="n">data_types</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Estimate memory usage for a given batch configuration.&quot;&quot;&quot;</span>
        <span class="n">memory_per_structure</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Coordinate data</span>
        <span class="n">memory_per_structure</span> <span class="o">+=</span> <span class="n">avg_atoms</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># float32 coordinates</span>

        <span class="c1"># Additional arrays based on data types requested</span>
        <span class="k">if</span> <span class="s1">&#39;contacts&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
            <span class="n">avg_contacts</span> <span class="o">=</span> <span class="n">avg_atoms</span> <span class="o">*</span> <span class="mi">5</span>  <span class="c1"># Rough estimate</span>
            <span class="n">memory_per_structure</span> <span class="o">+=</span> <span class="n">avg_contacts</span> <span class="o">*</span> <span class="mi">8</span>  <span class="c1"># Contact data</span>

        <span class="k">if</span> <span class="s1">&#39;fragments&#39;</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
            <span class="n">avg_fragments</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">avg_atoms</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">memory_per_structure</span> <span class="o">+=</span> <span class="n">avg_fragments</span> <span class="o">*</span> <span class="mi">12</span>  <span class="c1"># Fragment data</span>

        <span class="n">total_memory</span> <span class="o">=</span> <span class="n">batch_size</span> <span class="o">*</span> <span class="n">memory_per_structure</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># Safety factor</span>
        <span class="k">return</span> <span class="n">total_memory</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">optimize_batch_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_batch_size</span><span class="p">,</span> <span class="n">avg_atoms</span><span class="p">,</span> <span class="n">data_types</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find optimal batch size that fits in available memory.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">batch_size</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">initial_batch_size</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">estimated_memory</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_batch_memory</span><span class="p">(</span>
                <span class="n">batch_size</span><span class="p">,</span> <span class="n">avg_atoms</span><span class="p">,</span> <span class="n">data_types</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">estimated_memory</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_memory</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">batch_size</span>
        <span class="k">return</span> <span class="mi">1</span>
</pre></div>
</div>
<p><strong>Tensor Optimization Patterns</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">optimize_tensor_operations</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performance optimization patterns for tensor operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 1. Use in-place operations when possible</span>
    <span class="n">tensor</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">other_tensor</span><span class="p">)</span>  <span class="c1"># Instead of tensor = tensor + other_tensor</span>

    <span class="c1"># 2. Minimize device transfers</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="n">device</span><span class="p">):</span>
        <span class="c1"># Keep all operations on same device</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">tensor1</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">tensor2</span><span class="p">)</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">bias</span><span class="p">)</span>

    <span class="c1"># 3. Use appropriate data types</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>  <span class="c1"># Mixed precision</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

    <span class="c1"># 4. Leverage vectorization</span>
    <span class="c1"># Instead of loops, use batch operations</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">coords1</span><span class="p">,</span> <span class="n">coords2</span><span class="p">)</span>  <span class="c1"># Vectorized distance matrix</span>

    <span class="c1"># 5. Memory-efficient attention patterns</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">sdp_kernel</span><span class="p">(</span><span class="n">enable_math</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="c1"># Use optimized kernels when available</span>
        <span class="n">attention_output</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">scaled_dot_product_attention</span><span class="p">(</span>
            <span class="n">query</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span>
        <span class="p">)</span>
</pre></div>
</div>
<section id="testing-and-validation">
<h2>Testing and Validation<a class="headerlink" href="#testing-and-validation" title="Link to this heading"></a></h2>
</section>
</section>
<section id="unit-testing-framework">
<h1>Unit Testing Framework<a class="headerlink" href="#unit-testing-framework" title="Link to this heading"></a></h1>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">crystal_analyzer</span><span class="w"> </span><span class="kn">import</span> <span class="n">CrystalAnalyzer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">csa_config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExtractionConfig</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TestGeometryCalculations</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test suite for geometric calculation algorithms.&quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sample_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate test coordinate data.&quot;&quot;&quot;</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 2 structures, 10 atoms each</span>
        <span class="k">return</span> <span class="n">coords</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sample_cell_matrices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate test unit cell matrices.&quot;&quot;&quot;</span>
        <span class="c1"># Cubic cells for simplicity</span>
        <span class="n">matrices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">matrices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">10.0</span>  <span class="c1"># 10 Å cube</span>
        <span class="n">matrices</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">15.0</span>  <span class="c1"># 15 Å cube</span>
        <span class="k">return</span> <span class="n">matrices</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_distance_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample_coordinates</span><span class="p">,</span> <span class="n">sample_cell_matrices</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test periodic distance calculations.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">geometry_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_distances_periodic_batch</span>

        <span class="n">coords</span> <span class="o">=</span> <span class="n">sample_coordinates</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="n">sample_cell_matrices</span>

        <span class="n">distances</span> <span class="o">=</span> <span class="n">compute_distances_periodic_batch</span><span class="p">(</span>
            <span class="n">coords</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">cells</span><span class="p">,</span> <span class="n">use_minimum_image</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="c1"># Check dimensions</span>
        <span class="k">assert</span> <span class="n">distances</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="c1"># Check diagonal is zero (self-distances)</span>
        <span class="n">diagonal</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">dim1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim2</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">diagonal</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">diagonal</span><span class="p">),</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>

        <span class="c1"># Check symmetry</span>
        <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">distances</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_inertia_tensor_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample_coordinates</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test inertia tensor eigenvalue calculation.&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">geometry_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_inertia_tensor_batch</span>

        <span class="n">coords</span> <span class="o">=</span> <span class="n">sample_coordinates</span>
        <span class="n">masses</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># Unit masses</span>
        <span class="n">com</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Center of mass</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>

        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">compute_inertia_tensor_batch</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">masses</span><span class="p">,</span> <span class="n">com</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

        <span class="c1"># Check dimensions</span>
        <span class="k">assert</span> <span class="n">eigvals</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">eigvecs</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

        <span class="c1"># Check eigenvalues are non-negative and sorted</span>
        <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">eigvals</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">eigvals</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;=</span> <span class="n">eigvals</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Check eigenvectors are orthonormal</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">dot_products</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">eigvecs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">eigvecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">dot_products</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Integration Testing</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestPipelineIntegration</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test complete pipeline workflows.&quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimal_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tmp_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create minimal test configuration.&quot;&quot;&quot;</span>
        <span class="n">config_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;extraction&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;data_directory&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">tmp_path</span><span class="p">),</span>
                <span class="s2">&quot;data_prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
                <span class="s2">&quot;actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;get_refcode_families&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;cluster_refcode_families&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;get_unique_structures&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;get_structure_data&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s2">&quot;post_extraction_process&quot;</span><span class="p">:</span> <span class="kc">True</span>
                <span class="p">},</span>
                <span class="s2">&quot;filters&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;structure_list&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cif&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">tmp_path</span> <span class="o">/</span> <span class="s2">&quot;test_structures&quot;</span><span class="p">)]</span>
                <span class="p">},</span>
                <span class="s2">&quot;extraction_batch_size&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="s2">&quot;post_extraction_batch_size&quot;</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">config_file</span> <span class="o">=</span> <span class="n">tmp_path</span> <span class="o">/</span> <span class="s2">&quot;test_config.json&quot;</span>
        <span class="n">config_file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">config_data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ExtractionConfig</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_complete_pipeline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minimal_config</span><span class="p">,</span> <span class="n">sample_cif_files</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test complete pipeline execution.&quot;&quot;&quot;</span>
        <span class="n">analyzer</span> <span class="o">=</span> <span class="n">CrystalAnalyzer</span><span class="p">(</span><span class="n">minimal_config</span><span class="p">)</span>

        <span class="c1"># Should complete without errors</span>
        <span class="n">analyzer</span><span class="o">.</span><span class="n">extract_data</span><span class="p">()</span>

        <span class="c1"># Check output files exist</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">minimal_config</span><span class="o">.</span><span class="n">data_directory</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="s2">&quot;structures&quot;</span> <span class="o">/</span> <span class="s2">&quot;test_structures_processed.h5&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

        <span class="c1"># Validate output data</span>
        <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="s2">&quot;structures&quot;</span> <span class="o">/</span> <span class="s2">&quot;test_structures_processed.h5&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">assert</span> <span class="s1">&#39;refcode_list&#39;</span> <span class="ow">in</span> <span class="n">f</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;refcode_list&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">assert</span> <span class="s1">&#39;cell_volume&#39;</span> <span class="ow">in</span> <span class="n">f</span>
            <span class="k">assert</span> <span class="s1">&#39;atom_coords&#39;</span> <span class="ow">in</span> <span class="n">f</span>
</pre></div>
</div>
<section id="documentation-and-maintenance">
<h2>Documentation and Maintenance<a class="headerlink" href="#documentation-and-maintenance" title="Link to this heading"></a></h2>
</section>
</section>
<section id="code-documentation-standards">
<h1>Code Documentation Standards<a class="headerlink" href="#code-documentation-standards" title="Link to this heading"></a></h1>
<p><strong>Docstring Format</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_molecular_descriptors</span><span class="p">(</span>
        <span class="n">coords</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">masses</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
    <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Compute comprehensive molecular descriptors from atomic coordinates.</span>

<span class="s2">    This function calculates a wide range of geometric and topological</span>
<span class="s2">    descriptors used in crystal structure analysis, including moments</span>
<span class="s2">    of inertia, asphericity, planarity metrics, and shape descriptors.</span>

<span class="s2">    Parameters</span>
<span class="s2">    ----------</span>
<span class="s2">    coords : torch.Tensor, shape (B, N, 3)</span>
<span class="s2">        Cartesian coordinates of atoms for B structures with up to N atoms each.</span>
<span class="s2">        Coordinates should be in Ångström units.</span>
<span class="s2">    masses : torch.Tensor, shape (B, N)</span>
<span class="s2">        Atomic masses in atomic mass units (Da). Padding positions should</span>
<span class="s2">        have mass 0.0.</span>
<span class="s2">    device : torch.device</span>
<span class="s2">        PyTorch device for computation (CPU or CUDA).</span>

<span class="s2">    Returns</span>
<span class="s2">    -------</span>
<span class="s2">    descriptors : dict of str to torch.Tensor</span>
<span class="s2">        Dictionary containing computed descriptors:</span>

<span class="s2">        - &#39;moments_of_inertia&#39;: torch.Tensor, shape (B, 3)</span>
<span class="s2">            Principal moments of inertia in ascending order</span>
<span class="s2">        - &#39;asphericity&#39;: torch.Tensor, shape (B,)</span>
<span class="s2">            Measure of deviation from spherical shape</span>
<span class="s2">        - &#39;acylindricity&#39;: torch.Tensor, shape (B,)</span>
<span class="s2">            Measure of deviation from cylindrical shape</span>
<span class="s2">        - &#39;planarity_score&#39;: torch.Tensor, shape (B,)</span>
<span class="s2">            Measure of molecular planarity (0=linear, 1=planar)</span>

<span class="s2">    Raises</span>
<span class="s2">    ------</span>
<span class="s2">    ValueError</span>
<span class="s2">        If input tensors have incompatible shapes or contain invalid values.</span>
<span class="s2">    RuntimeError</span>
<span class="s2">        If GPU computation fails due to memory constraints.</span>

<span class="s2">    Notes</span>
<span class="s2">    -----</span>
<span class="s2">    This function uses the convention where moments of inertia are computed</span>
<span class="s2">    about the center of mass and sorted in ascending order. The asphericity</span>
<span class="s2">    and acylindricity parameters follow the definitions of:</span>

<span class="s2">    - Asphericity: I₃ - 0.5(I₁ + I₂)</span>
<span class="s2">    - Acylindricity: I₂ -Technical Details</span>
</pre></div>
</div>
<hr class="docutils" />
<p>Deep dive into CSA’s architecture, algorithms, and implementation details. This section provides comprehensive technical information for developers, advanced users, and researchers who need to understand the inner workings of the system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section assumes familiarity with crystallography, computational chemistry, and software engineering concepts.</p>
</div>
<section id="architecture-overview">
<h2>Architecture Overview<a class="headerlink" href="#architecture-overview" title="Link to this heading"></a></h2>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 sd-g-3 sd-g-xs-3 sd-g-sm-3 sd-g-md-3 sd-g-lg-3 docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🏗️ System Architecture</div>
<p class="sd-card-text">Overall system design, component interactions, and data flow patterns.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">architecture</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
⚡ Performance Optimization</div>
<p class="sd-card-text">GPU acceleration, memory management, and computational efficiency.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">performance</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
💾 Data Storage Design</div>
<p class="sd-card-text">HDF5 organization, variable-length arrays, and storage optimization.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">storage_design</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🔧 Configuration System</div>
<p class="sd-card-text">Configuration validation, inheritance, and parameter management.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">config_system</span></div>
</div>
</div>
</div>
</section>
<section id="algorithms-and-methods">
<h2>Algorithms and Methods<a class="headerlink" href="#algorithms-and-methods" title="Link to this heading"></a></h2>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 sd-g-3 sd-g-xs-3 sd-g-sm-3 sd-g-md-3 sd-g-lg-3 docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🔍 Similarity Clustering</div>
<p class="sd-card-text">Packing similarity metrics and clustering methodologies.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">clustering_algorithms</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
📐 Geometric Calculations</div>
<p class="sd-card-text">Distance calculations, coordinate transformations, and geometric descriptors.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">geometry_algorithms</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🧩 Fragment Analysis</div>
<p class="sd-card-text">Rigid fragment identification and property calculations.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">fragment_algorithms</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🔗 Contact Detection</div>
<p class="sd-card-text">Intermolecular contact identification and hydrogen bond detection.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">contact_algorithms</span></div>
</div>
</div>
</div>
</section>
<section id="implementation-details">
<h2>Implementation Details<a class="headerlink" href="#implementation-details" title="Link to this heading"></a></h2>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 sd-g-3 sd-g-xs-3 sd-g-sm-3 sd-g-md-3 sd-g-lg-3 docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🐍 Python Implementation</div>
<p class="sd-card-text">Core Python modules, class hierarchies, and design patterns.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">python_details</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🔥 PyTorch Integration</div>
<p class="sd-card-text">GPU tensor operations, batch processing, and memory optimization.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">pytorch_details</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
📊 HDF5 Integration</div>
<p class="sd-card-text">Dataset organization, compression, and efficient I/O patterns.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">hdf5_details</span></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
🔌 CSD Integration</div>
<p class="sd-card-text">Cambridge Structural Database API usage and data extraction.</p>
</div>
<span class="sd-stretched-link sd-hide-link-text">csd_integration</span></div>
</div>
</div>
</div>
</section>
<section id="system-architecture">
<h2>System Architecture<a class="headerlink" href="#system-architecture" title="Link to this heading"></a></h2>
</section>
</section>
<section id="high-level-design">
<h1>High-Level Design<a class="headerlink" href="#high-level-design" title="Link to this heading"></a></h1>
<p>CSA follows a modular, pipeline-based architecture designed for scalability and maintainability:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Configuration │    │   CSD Interface │    │  Data Validation│
│     Manager     │────│    &amp; Querying   │────│   &amp; Filtering   │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                        │                        │
         ▼                        ▼                        ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ Family Extraction│    │   Clustering    │    │  Representative │
│   &amp; Grouping    │────│   &amp; Similarity  │────│   Selection     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                        │                        │
         ▼                        ▼                        ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Structure     │    │  Feature        │    │   Output        │
│   Extraction    │────│  Engineering    │────│  Generation     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
</pre></div>
</div>
</section>
<section id="core-components">
<h1>Core Components<a class="headerlink" href="#core-components" title="Link to this heading"></a></h1>
<p><strong>Pipeline Orchestrator</strong> (<a href="#id1"><span class="problematic" id="id2">``</span></a>C</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api_reference/generated/structure_post_extraction_processor.BondParams.html" class="btn btn-neutral float-left" title="structure_post_extraction_processor.BondParams" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Nikolaos Galanakis .
      <span class="lastupdated">Last updated on Jul 01, 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>